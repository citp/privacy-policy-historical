<!--The following is the downloaded HTML source of the ceo.ca privacy policy that was archived on 2018-06-25.
 Please check the original snapshot on the Wayback Machine (https://web.archive.org/web/20180625110604id_/https%3A//ceo.ca/%40tommy/privacy-policy) for the most accurate reproduction.-->

<!DOCTYPE html><html><head>
        <link href="https://fonts.googleapis.com/css?family=PT+Mono" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=PT+Sans:400,700" rel="stylesheet" type="text/css">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, viewport-fit=cover">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <link href="/public/assets/icon-144x144.png" sizes="144x144" rel="apple-touch-icon">
        <link rel="shortcut icon" href="/public/assets/favicon.png?v=369-2" type="image/x-icon">

        
            <meta name="description" content="This Privacy Policy was last updated on February 4, 2017.">
        

        
            <title>CEO.CA Privacy Policy, by @tommy</title>
        

        <link rel="stylesheet" href="/public/styles/teaorbit.css?v=369-2" type="text/css">
        <link rel="stylesheet" href="/public/styles/icons.css?v=369-2" type="text/css">
        <link rel="stylesheet" type="text/css" href="/public/styles/medium-editor/image-insert-plugin.css">

    </head>

    
    

    <body class=" watchlist-open discover-open">
        <div id="container">
            <div id="header">
                <div id="back" class="hidden">
                    <span class="icon icon-chevron-left"></span>back
                </div>
                <div id="logo">
                    <a href="/" class="go-to" data-channel=""><img src="/public//assets/ceo.ca.png"></a>
                    
                </div>

                <div class="top-bar">
                    <label class="search-bar">
                        <form class="search-form">
                            <span class="icon icon-search"></span><input type="text" class="search-query" placeholder="Search">
                            <input type="submit" value="Search" style="display: none;">
                            <div class="suggestions"></div>
                        </form>
                    </label>
                </div>
                <div id="toggle-right-sidebar" class="toggle-sidebar ">
                    <div class="notifications">3</div>
                    <span class="icon icon-th-list"></span>
                </div>
            </div>

            <svg height="0" width="0" xmlns="http://www.w3.org/2000/svg" class="hidden">
                <filter id="drop-shadow">
                    <feGaussianBlur in="SourceAlpha" stdDeviation="1"></feGaussianBlur>
                    <feOffset dx="0" dy="0" result="offsetblur"></feOffset>
                    <feFlood flood-color="rgba(0,0,0,0.3)"></feFlood>
                    <feComposite in2="offsetblur" operator="in"></feComposite>
                    <feMerge>
                        <feMergeNode></feMergeNode>
                        <feMergeNode in="SourceGraphic"></feMergeNode>
                    </feMerge>
                </filter>
            </svg>
            <div id="nav">

                
                
                
                <div class="tab  toggle-left-sidebar">
                    <div class="shadow"></div>
                    <div class="shadowed">
                        <svg viewBox="0 0 5 40">
                            <path d="M0,40 L5,5 L5,40 L0,40"></path>
                        </svg></div><div class="label"><span class="icon icon-newspaper-o"></span> Articles
                    </div><div class="shadowed">
                        <svg viewBox="0 0 5 40">
                            <path d="M0,5 L5,40 L0,40 L0,5"></path>
                        </svg>
                    </div>
                </div><div class="tab current toggle-chat">
                    <div class="shadow"></div>
                    <div class="shadowed">
                        <svg viewBox="0 0 5 40">
                            <path d="M0,40 L5,5 L5,40 L0,40"></path>
                        </svg></div><div class="label">
                        <span class="channel">
                            @tommy/privacy-policy
                        </span> channel
                    </div><div class="shadowed">
                        <svg viewBox="0 0 5 40">
                            <path d="M0,5 L5,40 L0,40 L0,5"></path>
                        </svg>
                    </div>
                </div>

            </div>

            <div class="left-sidebar ">
                <div class="scroll">
                    

                     <div id="shared-watchlist">
                         
                    </div>

                    <div id="profile">
                        
                    </div>

                    <div id="chart-box" class="">
                        
                    </div>

                    <div class="pro-banner">
                        
        <a class="get-pro new" href="/about/market-depth" target="_new">
            <span class="icon"><img src="/public/assets/depth.png"></span>
            <div class="text">
                <div class="h1">Get CEO.CA Pro</div>
                <div class="h2">Real-time Level 2 Market Depth</div>
            </div>
        </a>


                    </div>
                    
                    <div class="padding channel-articles discover">
                        
<div class="articles">
    
        
    
        
    
        
            <h3>featured articles</h3>

            
            
                <!--
                
                    
                    --><a class="go-to article-link unseen" data-channel="@Goldfinger/observations-from-the-yukon-and-a-failed-breakdown-in-the-gold-miners" href="/@Goldfinger/observations-from-the-yukon-and-a-failed-breakdown-in-the-gold-miners" data-type="featured" data-index="0">
                        
                        <div class="article ">
                            <div class="thumb">
                                
                                    <img src="https://s3-us-west-2.amazonaws.com/cdn.ceo.ca/1dj0akl-GDX_Daily_6-120-80-thumb.24.2018.png">
                                
                            </div>
                            <div class="details">
                                <span class="date">June 24, 2018</span>
                                
                                <br>
                                <span class="author" data-channel="@Goldfinger" href="/@Goldfinger">@Goldfinger</span> <span class="title">Observations From The Yukon And A Failed Breakdown In The Gold Miners</span>
                                
                                
                            </div>
                        </div>
                    </a><!--
                
                    
                    --><a class="go-to article-link unseen" data-channel="@nasdaq/recommended-cash-offer-by-orion-mine-finance-to-acquire" href="/@nasdaq/recommended-cash-offer-by-orion-mine-finance-to-acquire" data-type="featured" data-index="1">
                        
                        <div class="article ">
                            <div class="thumb">
                                
                                    <img src="/public/assets/icon-bnw.png">
                                
                            </div>
                            <div class="details">
                                <span class="date">June 20, 2018</span>
                                
                                <br>
                                <span class="author" data-channel="@nasdaq" href="/@nasdaq">@nasdaq</span> <span class="title">Recommended Cash Offer by Orion Mine Finance to Acquire Dalradian Resources Inc.</span>
                                
                                
                                    <span class="hash cash" data-channel="DNA">$DNA</span>
                                
                                    <span class="hash cash" data-channel="DALR">$DALR</span>
                                
                            </div>
                        </div>
                    </a><!--
                
                    
                    --><a class="go-to article-link unseen" data-channel="@Oreninc/oreninc-index-falls-financing-drought-continues" href="/@Oreninc/oreninc-index-falls-financing-drought-continues" data-type="featured" data-index="2">
                        
                        <div class="article ">
                            <div class="thumb">
                                
                                    <img src="https://s3-us-west-2.amazonaws.com/cdn.ceo.ca/1dih7up-Index%2520Image%25206-14-18-01-120-80-thumb.jpg">
                                
                            </div>
                            <div class="details">
                                <span class="date">June 18, 2018</span>
                                
                                <br>
                                <span class="author" data-channel="@Oreninc" href="/@Oreninc">@Oreninc</span> <span class="title">ORENINC INDEX falls, financing drought continues</span>
                                
                                
                            </div>
                        </div>
                    </a><!--
                
                    
                    --><a class="go-to article-link unseen" data-channel="@tommy/former-speaker-boehner-makes-a-cool-million-on-arizona-mining-deal" href="/@tommy/former-speaker-boehner-makes-a-cool-million-on-arizona-mining-deal" data-type="featured" data-index="3">
                        
                        <div class="article ">
                            <div class="thumb">
                                
                                    <img src="https://s3-us-west-2.amazonaws.com/cdn.ceo.ca/1digkj0-Boehner-120-80-thumb.jpg">
                                
                            </div>
                            <div class="details">
                                <span class="date">June 18, 2018</span>
                                
                                <br>
                                <span class="author" data-channel="@tommy" href="/@tommy">@tommy</span> <span class="title">Former Speaker Boehner Earns a Cool Million on Arizona Mining Deal</span>
                                
                                
                            </div>
                        </div>
                    </a><!--
                
                -->
            
            <div class="load-more load-more-featured" data-type="featured" data-before="1529368094772">show more ▾</div>
        
    
        
    
</div>

                    </div>
                    <div class="padding legal">
                        <h3>read first</h3>
                        <div class="text" style="margin-top: 5px;">
                            Please read the <a href="/@tommy/ceoca-house-rules" class="hash go-to" data-channel="@tommy/ceoca-house-rules">CEO.CA House Rules</a> before posting.
                        </div>
                        <h3>legal</h3>
                        <div class="text" style="margin-top: 5px;">
                            Use of this site indicates acceptance of the
                            <a href="/@tommy/privacy-policy" class="hash go-to" data-channel="@tommy/privacy-policy">Privacy Policy</a>
                            and
                            <a href="/@tommy/terms-of-use" class="hash go-to" data-channel="@tommy/terms-of-use">Terms of Use</a>.
                        </div>
                        <div class="text">
                            <div style="margin-top: 10px;">
                                The information on this Website is not reliable and not intended to provide tax, legal, or investment advice. Nothing contained on the Website shall be considered a recommendation, solicitation, or offer to buy or sell a security to any person in any jurisdiction.    
                            </div>

                            <div style="margin-top: 10px;">CEO.CA members discuss high-risk penny stocks which can lose their entire value. Only risk what you can afford to lose. </div>

                            <div style="margin-top: 10px;">© 2016 - Pacific Website Company Inc.</div>
                        </div>
                    </div>
                </div>
                <div class="header">
                    
<div class="see-all">
    
        
            <div class="fullname">
                Articles
            </div>
        
    
</div>

                </div>
            </div>

            <div id="center-column" class="article-mode">

                <div id="toolbar">
                    <div id="moderator">
                        
<div id="current-channel" class="formatted-channel">
        <span class="channel @tommy/privacy-policy">
            
            @tommy/privacy-policy
        </span>
    <div class="online action leftpad toggle " id="num-online">
        
            <span class="details">
                
                    <span class="icon icon-users" style="font-size: 10px;"></span>
                    1 online
                
            </span>
        
    </div>

    <div class="controls">
        <span class="action toggle open-filters " href="">
            <span class="icon icon-filter" style="margin-right: 4px;"></span><span class="desc">Filters</span><span class="icon chevron icon-chevron-down"></span>
        </span><!--
        --><span class="action toggle open-datepicker " href="">
            <span class="icon icon-clock" style="margin-right: 4px;"></span><span class="desc">Archives</span><span class="icon chevron icon-chevron-down"></span>
        </span><!--
        
            -->
            
                <span class="action toggle subscribe open-notifications " href="">
                    
                        <span class="call-to-action"><span class="icon icon-plus"></span> subscribe</span>
                    
                </span>
             
        
    </div>
</div>

<div class="expanded scroll ">
    
        <div style="text-align: center;">
            Members of
            @tommy/privacy-policy
            
            
        </div>
        <div class="section">
            <h5>Moderators</h5>
            <table>
                
            </table>
        </div>
        <div class="section">
            <h5>Members</h5>
            <table>
                
            </table>
        </div>
        
        
    
</div>

                    </div>

                    
                    <div id="spiel-filters" class="toolbar-dropdown ">
                        
                    </div>
                    <div id="notifications" class="toolbar-dropdown"></div>
                    <div id="jump-to-date" class="toolbar-dropdown"></div>
                    <div id="online-list" class="scroll" style="display: none;"></div>
                </div>

                <div id="home" class="hidden">
                    
                    


                </div>
                <div id="chat" class="scroll hardware-acceleration ">

                    <div class="padding">

                        <div id="article-container">
                            
                                <div id="article" class="">
    <div class="article-inner">
        

            

            <div class="author">
                by <a data-channel="@tommy" class="hash at" href="/@tommy">@tommy</a> on February 11, 2016 
                
            </div>
            <div class="title">CEO.CA Privacy Policy</div>
            <div class="actions">

                
                
                <span style="font-size: 18px;">
                    <a class="share-button" href="http://www.facebook.com/sharer.php?u=https://ceo.ca/@tommy/privacy-policy" target="_blank"><span class="icon icon-facebook2"></span></a>
<a class="share-button" href="http://twitter.com/share?url=https://ceo.ca/@tommy/privacy-policy&amp;hashtags=&amp;text=CEO.CA Privacy Policy%20by%20@tommy" target="_blank"><span class="icon icon-twitter2"></span></a>
<a class="share-button" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://ceo.ca/@tommy/privacy-policy&amp;summary=CEO.CA Privacy Policy%20by%20@tommy&amp;title=CEO.ca CEO.CA Privacy Policy" target="_blank"><span class="icon icon-linkedin"></span></a>
<a class="share-button" target="_blank" href="mailto:?Subject=An article from CEO.ca&amp;Body=CEO.CA%20Privacy%20Policy%20by%20%40tommy%0A%0Ahttps://ceo.ca/@tommy/privacy-policy"><span class="icon icon-mail"></span></a>
<a class="share-button url" target="_blank" href="https://ceo.ca/@tommy/privacy-policy"><span class="icon icon-link"></span></a>

                </span>
                

            </div>
            <div class="article-body article">
                <p class="">This Privacy Policy was last updated on February 4, 2017.<br></p><p>This Privacy Policy is part of the Website’s <a href="/@tommy/terms-of-use">Terms of Use</a>&nbsp;(the “Terms”). Please note that all the capitalized terms not defined in this Privacy Policy are defined in the Terms.</p><p>The Operator respects and upholds an individual’s right to privacy and to protection of his or her Personal Information (as defined below). Should you choose to provide Personal Information to us, we will use reasonable security safeguards to ensure that your information is protected.</p><p>This Privacy Policy applies to all visitors to the Website, including both Members and non-Members. This Privacy Policy governs how the Operator collects, uses, and discloses Personal Information of visitors to the Website. Please note that this Privacy Policy applies only to information collected via the Website and does not apply to information obtained or disclosed in offline correspondence.</p><p>By using the Website, you acknowledge that you have reviewed the terms of this Privacy Policy and consent to the collection, use, disclosure, and transfer of your Personal Information in accordance with this Privacy Policy.</p><p>1.  Definitions</p><p>“Member” means a person who is an individual who has satisfied all membership requirements by providing certain required Personal Information to the Operator for the purpose of gaining access to certain portion of the Website (such as chat.ceo.ca), and thereafter remains in good standing.</p><p>“Third Party” means an individual or an organization other than the Operator.</p><p>“Personal Information” means information about an identifiable individual as defined in applicable privacy legislation. It does not include aggregate information which cannot be associated with a specific individual and it does not include the name, title, business address, or business telephone number or other contact information about an individual at a place of business.</p><p>“Privacy Officer” means the person within the Operator’s organization responsible for the Operator’s compliance with this Privacy Policy.</p><p>“You” or “your” for the purposes of this Privacy Policy means visitors of the Website, including both Members and non-Members.  </p><p>2.  Accountability</p><p>The Operator is accountable for the Personal Information under its control. The Operator has appointed a Privacy Officer who is responsible for the Operator’s compliance with this Privacy Policy.</p><p>3.  Collection of Personal Information</p><p>Non-Members: When you browse the Website, you do so anonymously. The Operator does not collect Personal Information about you unless you voluntarily provide it to us when registering with the Website in order to access Members-only portions of the Website, submitting an inquiry to us, or for any other purposes that are identified when or before the time the Personal Information is collected.</p><p>Members: Where you interact with the Website to access those sections of the Website that are restricted to Members, we may ask you to register and/or sign in and we will collect certain Personal Information from you if you do so. The Personal Information that we may collect for this purpose may include your name, title, company, business address and phone number, and email address, and any other Personal Information that you choose to provide to us. The Operator collects this information for the purpose of enabling Members’ access to these restricted areas. Access is granted by submitting certain Personal Information for authentication.</p><p>Inquiries: You may submit an inquiry to us through the “Contact” link of the Website (ceo.ca/contact/). We may ask for certain Personal Information such as your name, e-mail address, and so on. We collect this information in order to enable us to respond to your inquiries in as thorough a manner as possible.</p><p>Server logs: Our servers automatically log information about visits to the Website in the normal course of establishing and maintaining web connections. The server logs record statistical information, such as visitors’ IP addresses, time and duration of visit, and websites visited. We collect this information so that we may continuously improve our Content. These statistics are reported in aggregate form only. We may process and use this aggregate data for various purposes, including, but not limited to, analysis of this data for trends and statistics, development of the Website and the Website’s features and offerings, assessing patterns of use, or planning and evaluating marketing initiatives. We do not link server log information to any other data in a way that would enable us to identify individual visitors.</p><p>Cookies: Cookies are small text files that contain a unique identifier that is placed on your computer. When you visit the Website, the Website saves the file with a matching identifier. When you revisit the Website days or weeks later, depending on the settings of your Internet browser, the Website may be able to recognize you by matching the cookie on your computer with the matching identifier in its database. Many Internet browsers are initially set to accept cookies. If you do not wish to accept cookies, you can set yours to refuse cookies or to alert you when cookies are being sent. If you reject cookies, you may be limited in using some areas of the Website.</p><p>4.  Use and Disclosure of Personal Information</p><p>We do not use or disclose Personal Information for any purposes other than those identified in this Privacy Policy, except with your consent or as required by law. We do not sell, lease, or trade information about you to other parties. Personal Information is retained only as long as is necessary for the fulfillment of the purposes identified in this Privacy Policy.</p><p>We may share (provide and receive) aggregate information, which is not personally identifiable, with others. This information may include demographic data such as the gender and/or geographic location of groups of Members and non-Members, but it will not include personal information (such as your name or email address). We may use aggregate demographic information about visitors to the Website in order to improve the services offered on the Website, for marketing purposes and/or industry reporting purposes. Where Personal Information is disclosed to Third Parties for the fulfillment of purposes described in this Privacy Policy, such Third Parties receiving the disclosed Personal Information will be contractually obligated to maintain confidentiality and security of the Personal Information and will be restricted from using such information in any way not expressly authorized by the Operator.</p><p>5.  Consent</p><p>By submitting Personal Information to the Operator, you agree that the Operator may collect your Personal Information and you consent to the use, disclosure, and transfer of your Personal Information in accordance with this Privacy Policy and as permitted or required by law. In addition, you represent and warrant that you have the right and authority or have obtained all necessary consents to provide any information, including any Personal Information of another individual that is provided by you to the Operator.</p><p>You may refuse or withdraw consent at any time, subject to legal and contractual restrictions and reasonable notice. You may refuse or withdraw your consent by contacting the Privacy Officer at the address listed below. Our Privacy Officer will explain your options and any consequences of refusing or withdrawing consent, and will record your choices.</p><p>6. Accuracy</p><p>The Operator will make reasonable efforts to ensure that Personal Information is as accurate, complete, and current as required for the purposes for which it was collected. If you find any inaccuracies in our information, you can contact the Privacy Officer and we will make the appropriate corrections promptly.</p><p>7.  Safeguards</p><p>The Operator will use appropriate security safeguards to protect your Personal Information from risks such as unauthorized access, collection, use, disclosure, copying, modification or disposal or similar risks. Safeguards include physical, administrative, and electronic security measures. Nevertheless, Internet transmissions are never completely private or secure. You understand that any messages or information you send to the Website may be read or intercepted by others, and you should therefore take special care in deciding what information you send to us.</p><p>When we are required by law to provide information, we take reasonable steps to verify the lawful authority for the collection and we will disclose only the information that is legally required.</p><p>8.  Access</p><p>You have the right to access your Personal Information under the control of the Operator. Upon request in writing to the Privacy Officer at the address listed below, you will be informed of the existence, use, and disclosure of your Personal Information and you will be given access to that information. In certain exceptional situations, the Operator may not be able to provide access to certain Personal Information that it holds about you. For example, the Operator may not provide access to Personal Information if doing so would reveal Personal Information about another individual. If access cannot be provided, the Operator will notify you, in writing, of the reasons for the refusal and you may contact the Privacy Officer with respect to your questions about the refusal.</p><p>9.  Children</p><p>The Website is not directed to children under 18 years of age without appropriate parental notice and consent. Protecting the privacy of children is very important to us. We do not knowingly collect or maintain Personal Information from people under 18 years of age. If you are under 18, please do not send any information about yourself to us. In the event that we learn that we have collected Personal Information from a child under age 18 without verification of parental consent, we will delete that information as quickly as reasonably possible.</p><p>10.  Opt-Out</p><p>When appropriate, Members of the Website are given the opportunity to either: (i) opt-out of receiving newsletters, alerts, bulletins, or other similar communications from the Operator or (ii) remove their Personal Information from the Operator’s records. If you wish to opt-out in the manner as listed above, please contact the Operator’s Privacy Officer at the address listed below.</p><p>11. Links to Other Sites</p><p>The Website contains links to Third Party Websites. The Operator is not responsible for the collection of Personal Information or the security or privacy of such information on Third Party Websites. The Operator encourages you to request and review the privacy policies of any Third Party Websites. This Privacy Policy applies solely to information collected through the Website.</p><p>12.  Revisions to this Privacy Policy</p><p>The development of the Operator’s policies and procedures for the protection of Personal Information is an ongoing process. Due to changes in technology and legal requirements, we may revise this Privacy Policy from time to time, without prior notice to you. Please ensure that you refer to the current version of the Privacy Policy.</p><p>13.  Web Server Location</p><p>The web servers hosting the Website and your Personal Information are located in the United States. By using the Website and by voluntarily providing your Personal Information to us, you are consenting to the transfer of your Personal Information to the web servers hosting the Website in the United States. In addition, you acknowledge that your Personal Information may be available to the United States governments or agencies under a lawful order.</p><p>14. Addressing your Questions or Concerns</p><p>If you have a question regarding this Privacy Policy or a concern or complaint regarding the privacy practices of the Operator, please contact the Privacy Officer by e-mail at info@ceo.ca, or by regular mail at:</p><p>1040 Palmerston Ave</p><p>West Vancouver, BC</p><p>V7S 2J3, Canada</p><p>Within a reasonable time upon receiving a written complaint, the Privacy Officer will conduct an investigation into the matter. Within a reasonable time of concluding the investigation, the Privacy Officer will inform you whether the complaint will be allowed or denied. If the Privacy Officer allows the complaint, the Operator will take appropriate measure necessary to rectify the source of the complaint.</p>
                            
                        
                    
                            
                        
                    
                            
                        
                    
            </div>

            <div class="article-share-icons share-icons" style="text-align:center;font-size:22px;">
                <a class="share-button" href="http://www.facebook.com/sharer.php?u=https://ceo.ca/@tommy/privacy-policy" target="_blank"><span class="icon icon-facebook2"></span></a>
<a class="share-button" href="http://twitter.com/share?url=https://ceo.ca/@tommy/privacy-policy&amp;hashtags=&amp;text=CEO.CA Privacy Policy%20by%20@tommy" target="_blank"><span class="icon icon-twitter2"></span></a>
<a class="share-button" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://ceo.ca/@tommy/privacy-policy&amp;summary=CEO.CA Privacy Policy%20by%20@tommy&amp;title=CEO.ca CEO.CA Privacy Policy" target="_blank"><span class="icon icon-linkedin"></span></a>
<a class="share-button" target="_blank" href="mailto:?Subject=An article from CEO.ca&amp;Body=CEO.CA%20Privacy%20Policy%20by%20%40tommy%0A%0Ahttps://ceo.ca/@tommy/privacy-policy"><span class="icon icon-mail"></span></a>
<a class="share-button url" target="_blank" href="https://ceo.ca/@tommy/privacy-policy"><span class="icon icon-link"></span></a>

            </div>

            <div style="clear:both;"></div>

        
    </div>
</div>

                            
                        </div>

                        <div id="load-more-controls">
                            
                            
<div class="placeholder" style="height: 40px; display: none;">
    
        <div class="load-info">No more messages to load</div>
        <a href="#" class="load-more" style="display: none;" id="load-more"><span>see older messages</span></a>
    
</div>

                        </div>

                        <div class="inner">

                        </div>
                        
                            <span class="load-more load-more-half" id="load-more-below" style="display:none"><span class="load-messages">see newer messages</span> or <span class="return-to-chat">go to most recent</span></span>
                        
                    </div>
                </div>

                <div id="post" class="">
                    

    <div class="outer enabled">
        <div class="inner">
            
                <div class="unpostable"><span class="signup-now">Sign up</span> to become a contributing member of the community.</div>
            

        </div>

        
    </div>


                </div>

                <script async="" src="//www.google-analytics.com/analytics.js"></script><script type="text/javascript" src="/public/js/microtemplates.js?v=369-2"></script>
                <script type="text/javascript" src="/public/js/common.js?v=369-2"></script>
                <script type="text/html" id="spiel_tmpl" class="template">
                    <% 
    var truncate_threshold = 700;
    var truncate_padding = 50;
    var truncated = spiel.spiel.length > truncate_threshold + truncate_padding;
%>
<div class="message<% if (!spiel.timestamp){ %> unsent<% } %><% if (spiel.bot && spiel.bot == 'admin'){ %> system<% } %> <%= (spiel.fake || (spiel.score && spiel.score < -4)) ? 'shitpost' : '' %> <%= truncated ? 'truncated' : '' %>" id="message-<%=common.htmlentities(spiel.spiel_id)%>" channel="<%= common.htmlentities(spiel.channel) %>">
    <div class="color-wrap">
        <% if(spiel.bot){%>
            <% if (spiel.bot != 'admin') { %>
                <span class="color" style="background:<%= spiel.color %>;border-radius:2px"></span>
            <% } %>
        <%} else {%>
            <div class="color" style="background:<%=spiel.color%>"><span class='hover-tip'>click to invite</span></div>
        <% } %>
    </div>

    <% if (spiel.bot && spiel.bot == 'admin') { %>

    <% } else if(spiel.name) { %>
        <span class="name<%= (spiel.fake) ? ' fake' : '' %>"><%- common.linkify("", common.htmlentities(spiel.name)) %></span>
    <% } else { %>
        <span class="name anon">anonymous</span>
    <% } %>
    <% if (spiel.edit_active){ %>

        <span class='spiel-content' contenteditable class='edit_input' style="background:white;border-bottom:1px dashed rgba(0,0,0,0.4);"><%= spiel.spiel %></span><br>
        <input type='button' value='Submit' class='edit-submit edit-button log-button'>
        <input type='button' value='Cancel' class='edit-cancel edit-button log-button'>

    <% } else { %>
        <% if(truncated) { %>
            <span class="spiel-content spiel-summary" vote-count="<%= spiel.votes %>" editable="<%= spiel.editable %>"><%- common.sedi_buttons(common.photo_buttons(common.linkify("", common.htmlentities(spiel.spiel.substring(0, truncate_threshold), "_blank")))) %></span>
            <span class="spiel-content full-spiel" vote-count="<%= spiel.votes %>" editable="<%= spiel.editable %>"><%- common.sedi_buttons(common.photo_buttons(common.linkify("", common.htmlentities(spiel.spiel), "_blank"))) %></span>
        <% } else { %>
            <span class="spiel-content" vote-count="<%= spiel.votes %>" editable="<%= spiel.editable %>"><%- common.sedi_buttons(common.photo_buttons(common.linkify("", common.htmlentities(spiel.spiel), "_blank"))) %></span>
        <% } %>

    <% } %>
    <% if(truncated) { %>
        <span class="ellipsis">
            <% var words = spiel.spiel.substring(truncate_threshold).split(' ').length; %>
            + <%= words %> more words. <span class="expand">Click to expand</span>
        </span>
    <% } %>
</div>
<div class='vote-listener vote <%= spiel.voted ? 'voted' : '' %> <%= (spiel.votes > 0) ? "show" : "" %>'>
    <span class='vote-count'><%= spiel.votes %></span>
    <span class='icon-thumbsup'></span>
</div>

<% if (!spiel.actions.disable) { %>
    <div class="spiel-actions" id ="spiel-<%= spiel.spiel_id %>" <% if(!spiel.actions.show_actions) { %> style="display:none;" <% } %>>

        <table>
            <tr>
                <th>Share</th>
                <td>
                    <a class="share-button" href="http://twitter.com/share?url=<%= spiel.actions.base_url%>/<%= spiel.channel %>%3F<%= spiel.spiel_id %>&hashtags=&text=<%= spiel.actions.truncated_message %>" target="_blank"><span class='icon icon-twitter2'></span></a>

                    <a class="share-button" href="http://www.facebook.com/sharer.php?u=<%= spiel.actions.base_url%>/<%= spiel.channel %>%3F<%= spiel.spiel_id %>" target = "_blank"><span class='icon-facebook2 icon'></span></a>

                    <a class="share-button" href="http://www.linkedin.com/shareArticle?mini=true&url=<%= spiel.actions.base_url%>/<%= spiel.channel %>%3F<%= spiel.spiel_id %>&summary=<%= spiel.actions.truncated_message %>&title=A message from CEO.ca" target = "_blank"><span class='icon icon-linkedin'></span></a>

                    <a class="share-button" href="mailto:?Subject=A message from CEO.ca&Body=<%= spiel.actions.truncated_message %>%0A%0A<%= spiel.actions.base_url %>/<%= spiel.channel %>%3F<%= spiel.spiel_id %>" target="_blank"><span class='icon-mail icon'></span></a>

                    <a class="share-button deep-link"><span class='icon icon-link'></span></a>
                </td>
            </tr>
            <% if(logged_in) { %>
                <tr>
                    <th>Manage</th>
                    <td>
                        <% if (spiel.actions.role == 'site_moderator' || spiel.actions.role == 'public_moderator' || spiel.actions.admin || spiel.actions.role == 'moderator' || ((spiel.editable === true || spiel.editable === 1) && spiel.actions.recent)) { %>

                            <a class="edit" title="Edit message">
                                <span class="icon icon-pencil action"></span> <span class='text'>Edit</span>
                            </a>
                        <% } %>

                        <a class="<%- spiel.saved_id ? 'remove-favorite-spiel voted' : 'favorite-spiel' %>" id="favorite-<%= spiel.spiel_id %>" title="Bookmark message"><span class="icon icon-bookmarks action"></span> <span class='text'>Bookmark<span></a>
                        
                        <% if (spiel.actions.role == 'owner' || spiel.actions.role == 'site_moderator' || spiel.actions.role == 'public_moderator' || spiel.actions.admin || spiel.actions.role == 'moderator' || ((spiel.editable === true || spiel.editable === 1) && spiel.actions.recent)) { %>
                            <a class="remove-spiel" id="delete-<%= spiel.spiel_id %>" title="Delete message"><span class="icon icon-bin action"></span> <span class='text'>Delete<span></a>

                        <% } %>

                    </td>
                </tr>
            <% } %>
            <% if(logged_in && !spiel.own_spiel) { %>
                <tr>
                    <th>Moderate</th>
                    <td>
                        <a class="vote-listener flag-irrelevant <%= spiel.flagged ? 'voted' : '' %>" data-type="flag-irrelevant" title='Flag as Irrelevant'>
                            <span class='icon icon-flag'></span> <span class='text'>Flag<span>
                        </a>

                        <a class="ignore-user" data-spiel_id='<%= spiel.spiel_id %>' title='Ignore user'>
                            <span class='icon icon-mute'></span> <span class='text'>Ignore<span>
                        </a>
                        <a class="block-user" data-spiel_id='<%= spiel.spiel_id %>' title='Block user'>
                            <span class='icon icon-cross'></span> <span class='text'>Block<span>
                        </a>

                        <% if (spiel.actions.admin || spiel.actions.role == 'public_moderator' || spiel.actions.role == 'site_moderator') { %>
                            <a class="mute" title="Ban">
                                <span class="icon-auction icon <%- spiel.actions.role == 'public_moderator' ? 'public-mute' : '' %>"></span> <span class='text'>Ban<span>
                            </a>
                        <% } %>
                        <% if (false) { %>
                            <a class="" title="Mute">
                                <span class="icon-mute icon"></span>
                            </a>
                        <% } %>
                    </td>
                </tr>
            <% } %>
            <% if (spiel.actions.admin || spiel.actions.role == 'site_moderator') { %>
                <tr>
                    <th>Admin</th>
                    <td>
                        <a class="to-index" data-spiel-id="<%= spiel.spiel_id %>" title="Copy to #index">
                            <span class="icon icon-home"></span> <span class='text'>#index<span>
                        </a>
                        <% if(spiel.actions.admin) { %>
                            <a class="feature" title="Copy to #editors">
                                <span class="icon-star-full icon"></span> <span class='text'>Feature<span>
                            </a>
                            <a class="whois" data-spiel-id="<%= spiel.spiel_id %>" title="Who is ...?">
                                <span class='icon question'>?</span>
                                <span class='text'>Who<span>
                            </a>
                            <a class="go-to" href="/all/<%= spiel.spiel_id %>" data-channel="all/<%= spiel.spiel_id %>" data-spiel-id="<%= spiel.spiel_id %>" title="What they postin?">
                                <span class='icon'>&hellip;</span> <span class='text'>Posts<span>
                            </a>
                        <% } %>
                    </td>
                </tr>
            <% } %>
        </table>

    </div>
<% } %>

<% timestamp = parseInt(spiel.timestamp); %>
<span class="date">
    <% if(spiel.timestamp) { %>
        <% if(spiel.parent_id && spiel.parent_channel && spiel.parent_timestamp) { %>
            from
            <a class="hash" href="/<%= spiel.parent_channel %>?<%= spiel.parent_id %>" data-channel="<%= spiel.parent_channel %>" data-spiel_id="<%= spiel.parent_id %>">
                <%= common.format_channel(spiel.parent_channel) %>,
                <time datetime="<%= (new Date(spiel.parent_timestamp)).toISOString() %>" timestamp="<%= spiel.timestamp %>" title="<%= common.format_datetime(spiel.parent_timestamp) %>">
                    <%= common.format_datetime(spiel.parent_timestamp) %>
                </time>
            </a>
        <% } else { %>
             <time datetime="<%= (new Date(spiel.timestamp)).toISOString() %>" timestamp="<%= spiel.timestamp %>" title="<%= common.format_datetime(spiel.timestamp) %>">
                <%= common.format_datetime(spiel.timestamp) %>
            </time>
        <% } %>
    <% } else { %>
        sending...
    <% } %>
</span>


                </script>

                <!-- initial spiels may contain invalid characters, so take strict measures to flatten string (by using application/json mimetype) -->
                <script id="initial-spiels" type="application/json">
                    []
                </script>
                <script type="text/javascript">

                    window.initial_spiels = JSON.parse(document.getElementById('initial-spiels').innerHTML);
    
                    var spiel_template = document.getElementById('spiel_tmpl').innerHTML;

                    var logged_in = false
                    var current_channel = "@tommy/privacy-policy"
                    var role = null
                    var hostname = "ceo.ca"
                    var admin = false

                    var render_spiel = microtemplates(spiel_template);

                    spiel_html = "";

                    window.initial_spiels.forEach(function (spiel) {
                        spiel.actions = common.spiel_actions_data(spiel, hostname, admin, role)

                        spiel_html += '<div id="' + spiel.spiel_id + '" class="row">'
                        spiel_html += render_spiel({
                            spiel: spiel,
                            logged_in: logged_in,
                            current_channel: current_channel,
                            role: role,
                            common: common
                        });
                        spiel_html += '</div>';
                    });

                    document
                        .getElementById('chat')
                        .getElementsByClassName('inner')[0].innerHTML = spiel_html;

                    var post_height = document.getElementById('post').getElementsByClassName('outer')[0].clientHeight;
                    document.getElementById('chat').getElementsByClassName('padding')[0].style.paddingBottom = (post_height + 30) + "px";

                    
                </script>
            </div>

            <div id="channels" class="channels-list right-sidebar ">
                <div class="scroll main">

    <div class="default-channels column">
        <div class="padding">
            <div class="section">
                
                    <span class="button" id="login"><span class="icon icon-key"></span>Log in</span><br>
                    <span class="button" id="signup"><span class="icon icon-plus"></span>Sign up</span><br>
                
                <!--<span class="button open-search"><span class="icon icon-search"></span>Search</span><br />-->
                
                
                </div>
            </div>

            <div id="channels-inner">
                






    
    
        <div class="section channels" data-type="defaults">
            
            
            
            

            <div class="list">
                
                    
                    
<div class="channel  " channel="">
    <div class="new-count">
        
    </div><a class="go-to" data-channel="" href="/"><span class="icon icon-home"></span>home
        
        
    </a>
</div>



                
                    
                    
<div class="channel  " channel="feed">
    <div class="new-count">
        
    </div><a class="go-to" data-channel="feed" href="/feed"><span class="icon icon-notifications"></span>feed
        
        
    </a>
</div>



                

                

                
            </div>
        </div>
    

    
    

    
    
        <div class="section channels" data-type="featured">
            
            
                <h3 data-id="featured">
                    Featured
                    
                </h3>
            
            
            

            <div class="list">
                
                    
                    
<div class="channel  " channel="index">
    <div class="new-count">
        
    </div><a class="go-to" data-channel="index" href="/index"><span class="icon icon-sphere"></span>index
        
        
    </a>
</div>



                
                    
                    
<div class="channel  " channel="popular">
    <div class="new-count">
        
    </div><a class="go-to" data-channel="popular" href="/popular"><span class="icon icon-thumbsup"></span>popular
        
        
    </a>
</div>



                
                    
                    
<div class="channel  " channel="featured">
    <div class="new-count">
        
    </div><a class="go-to" data-channel="featured" href="/featured"><span class="icon icon-star-full"></span>editors
        
        
    </a>
</div>



                
                    
                    
<div class="channel  " channel="articles">
    <div class="new-count">
        
    </div><a class="go-to" data-channel="articles" href="/articles"><span class="icon icon-pencil"></span>articles
        
        
    </a>
</div>



                
                    
                    
<div class="channel  " channel="newsroom">
    <div class="new-count">
        
    </div><a class="go-to" data-channel="newsroom" href="/newsroom"><span class="icon icon-newspaper-o"></span>newsroom
        
        
    </a>
</div>



                
                    
                    
<div class="channel  " channel="insiders">
    <div class="new-count">
        
    </div><a class="go-to" data-channel="insiders" href="/insiders"><span class="icon icon-file-text"></span>insiders
        
        
    </a>
</div>



                
                    
                    
<div class="channel  " channel="feedback">
    <div class="new-count">
        
    </div><a class="go-to" data-channel="feedback" href="/feedback"><span class="icon icon-bubble"></span>feedback
        
        
    </a>
</div>



                

                

                
            </div>
        </div>
    

    
    

    
    

    
    






            </div>

            
        </div>
    </div>

    <div class="header">
        <span class="show-all-channels">
            Personal channels
        </span></div>
    </div>
</div>

            
        

        
            <div class="cover" id="signup-cover" style="display: none;">
                <div id="login-modal" class="modal generic big-buttons">
    <div class="outer">
        <div class="close-button">×</div>
        <div class="logo"></div>
        <div id="signup-box" class="scroll inner">
            <form id="registration" novalidate="">
                
                    <h1>Mobile Investment Conference</h1>
                    <div class="sub-2">
                        Share knowledge and track stocks in real-time among CEOs and market pros.
                    </div>
                
                
                <input type="email" name="email" required="true" placeholder="Your email" class="email registration-email"><button type="submit" data-text="Request Invite!" id="submit-registration">
                    Request Invite!
                </button>

                <div class="agree">
                    <label>
                        <input id="terms-checkbox" type="checkbox" name="agree" style="margin-right:10px;">I agree to the CEO.CA <a href="/@tommy/terms-of-use" target="new">Terms of Use</a> and <a href="/@tommy/privacy-policy" target="new">Privacy Policy</a>
                    </label>
                </div>
            </form>
            <div class="actions">
                <div class="action">
                    <span class="faint">Already a member?</span>
                    <br><a class="login-now">Log in</a> now.
                </div>
                <div class="action">
                    <span class="faint">Want to learn more?</span>
                    <br>Visit the <a target="new" href="/@tommy/about">About</a> page.
                </div>
            </div>
        </div>


        <div id="login-box" class="inner scroll" style="display:none;">
            <h1>Log in</h1>
            <form id="login-form">
                <input id="email" class="email" type="email" name="email" required="true" placeholder="email">
                <input id="password" class="password" type="password" name="password" required="true" placeholder="password">
                <button type="submit" id="submit-login">Log in</button><br>

                <a id="forgot_your_password">
                    forgot your password?
                </a>
            </form>
        </div>
    </div>
</div>


            </div>
        

        


        
            <script type="text/javascript" src="/public/js/mini.js?v=369-2"></script>
        

        

        

        
            <script type="text/html" id="spiel_tmpl" class="template">
                <% 
    var truncate_threshold = 700;
    var truncate_padding = 50;
    var truncated = spiel.spiel.length > truncate_threshold + truncate_padding;
%>
<div class="message<% if (!spiel.timestamp){ %> unsent<% } %><% if (spiel.bot && spiel.bot == 'admin'){ %> system<% } %> <%= (spiel.fake || (spiel.score && spiel.score < -4)) ? 'shitpost' : '' %> <%= truncated ? 'truncated' : '' %>" id="message-<%=common.htmlentities(spiel.spiel_id)%>" channel="<%= common.htmlentities(spiel.channel) %>">
    <div class="color-wrap">
        <% if(spiel.bot){%>
            <% if (spiel.bot != 'admin') { %>
                <span class="color" style="background:<%= spiel.color %>;border-radius:2px"></span>
            <% } %>
        <%} else {%>
            <div class="color" style="background:<%=spiel.color%>"><span class='hover-tip'>click to invite</span></div>
        <% } %>
    </div>

    <% if (spiel.bot && spiel.bot == 'admin') { %>

    <% } else if(spiel.name) { %>
        <span class="name<%= (spiel.fake) ? ' fake' : '' %>"><%- common.linkify("", common.htmlentities(spiel.name)) %></span>
    <% } else { %>
        <span class="name anon">anonymous</span>
    <% } %>
    <% if (spiel.edit_active){ %>

        <span class='spiel-content' contenteditable class='edit_input' style="background:white;border-bottom:1px dashed rgba(0,0,0,0.4);"><%= spiel.spiel %></span><br>
        <input type='button' value='Submit' class='edit-submit edit-button log-button'>
        <input type='button' value='Cancel' class='edit-cancel edit-button log-button'>

    <% } else { %>
        <% if(truncated) { %>
            <span class="spiel-content spiel-summary" vote-count="<%= spiel.votes %>" editable="<%= spiel.editable %>"><%- common.sedi_buttons(common.photo_buttons(common.linkify("", common.htmlentities(spiel.spiel.substring(0, truncate_threshold), "_blank")))) %></span>
            <span class="spiel-content full-spiel" vote-count="<%= spiel.votes %>" editable="<%= spiel.editable %>"><%- common.sedi_buttons(common.photo_buttons(common.linkify("", common.htmlentities(spiel.spiel), "_blank"))) %></span>
        <% } else { %>
            <span class="spiel-content" vote-count="<%= spiel.votes %>" editable="<%= spiel.editable %>"><%- common.sedi_buttons(common.photo_buttons(common.linkify("", common.htmlentities(spiel.spiel), "_blank"))) %></span>
        <% } %>

    <% } %>
    <% if(truncated) { %>
        <span class="ellipsis">
            <% var words = spiel.spiel.substring(truncate_threshold).split(' ').length; %>
            + <%= words %> more words. <span class="expand">Click to expand</span>
        </span>
    <% } %>
</div>
<div class='vote-listener vote <%= spiel.voted ? 'voted' : '' %> <%= (spiel.votes > 0) ? "show" : "" %>'>
    <span class='vote-count'><%= spiel.votes %></span>
    <span class='icon-thumbsup'></span>
</div>

<% if (!spiel.actions.disable) { %>
    <div class="spiel-actions" id ="spiel-<%= spiel.spiel_id %>" <% if(!spiel.actions.show_actions) { %> style="display:none;" <% } %>>

        <table>
            <tr>
                <th>Share</th>
                <td>
                    <a class="share-button" href="http://twitter.com/share?url=<%= spiel.actions.base_url%>/<%= spiel.channel %>%3F<%= spiel.spiel_id %>&hashtags=&text=<%= spiel.actions.truncated_message %>" target="_blank"><span class='icon icon-twitter2'></span></a>

                    <a class="share-button" href="http://www.facebook.com/sharer.php?u=<%= spiel.actions.base_url%>/<%= spiel.channel %>%3F<%= spiel.spiel_id %>" target = "_blank"><span class='icon-facebook2 icon'></span></a>

                    <a class="share-button" href="http://www.linkedin.com/shareArticle?mini=true&url=<%= spiel.actions.base_url%>/<%= spiel.channel %>%3F<%= spiel.spiel_id %>&summary=<%= spiel.actions.truncated_message %>&title=A message from CEO.ca" target = "_blank"><span class='icon icon-linkedin'></span></a>

                    <a class="share-button" href="mailto:?Subject=A message from CEO.ca&Body=<%= spiel.actions.truncated_message %>%0A%0A<%= spiel.actions.base_url %>/<%= spiel.channel %>%3F<%= spiel.spiel_id %>" target="_blank"><span class='icon-mail icon'></span></a>

                    <a class="share-button deep-link"><span class='icon icon-link'></span></a>
                </td>
            </tr>
            <% if(logged_in) { %>
                <tr>
                    <th>Manage</th>
                    <td>
                        <% if (spiel.actions.role == 'site_moderator' || spiel.actions.role == 'public_moderator' || spiel.actions.admin || spiel.actions.role == 'moderator' || ((spiel.editable === true || spiel.editable === 1) && spiel.actions.recent)) { %>

                            <a class="edit" title="Edit message">
                                <span class="icon icon-pencil action"></span> <span class='text'>Edit</span>
                            </a>
                        <% } %>

                        <a class="<%- spiel.saved_id ? 'remove-favorite-spiel voted' : 'favorite-spiel' %>" id="favorite-<%= spiel.spiel_id %>" title="Bookmark message"><span class="icon icon-bookmarks action"></span> <span class='text'>Bookmark<span></a>
                        
                        <% if (spiel.actions.role == 'owner' || spiel.actions.role == 'site_moderator' || spiel.actions.role == 'public_moderator' || spiel.actions.admin || spiel.actions.role == 'moderator' || ((spiel.editable === true || spiel.editable === 1) && spiel.actions.recent)) { %>
                            <a class="remove-spiel" id="delete-<%= spiel.spiel_id %>" title="Delete message"><span class="icon icon-bin action"></span> <span class='text'>Delete<span></a>

                        <% } %>

                    </td>
                </tr>
            <% } %>
            <% if(logged_in && !spiel.own_spiel) { %>
                <tr>
                    <th>Moderate</th>
                    <td>
                        <a class="vote-listener flag-irrelevant <%= spiel.flagged ? 'voted' : '' %>" data-type="flag-irrelevant" title='Flag as Irrelevant'>
                            <span class='icon icon-flag'></span> <span class='text'>Flag<span>
                        </a>

                        <a class="ignore-user" data-spiel_id='<%= spiel.spiel_id %>' title='Ignore user'>
                            <span class='icon icon-mute'></span> <span class='text'>Ignore<span>
                        </a>
                        <a class="block-user" data-spiel_id='<%= spiel.spiel_id %>' title='Block user'>
                            <span class='icon icon-cross'></span> <span class='text'>Block<span>
                        </a>

                        <% if (spiel.actions.admin || spiel.actions.role == 'public_moderator' || spiel.actions.role == 'site_moderator') { %>
                            <a class="mute" title="Ban">
                                <span class="icon-auction icon <%- spiel.actions.role == 'public_moderator' ? 'public-mute' : '' %>"></span> <span class='text'>Ban<span>
                            </a>
                        <% } %>
                        <% if (false) { %>
                            <a class="" title="Mute">
                                <span class="icon-mute icon"></span>
                            </a>
                        <% } %>
                    </td>
                </tr>
            <% } %>
            <% if (spiel.actions.admin || spiel.actions.role == 'site_moderator') { %>
                <tr>
                    <th>Admin</th>
                    <td>
                        <a class="to-index" data-spiel-id="<%= spiel.spiel_id %>" title="Copy to #index">
                            <span class="icon icon-home"></span> <span class='text'>#index<span>
                        </a>
                        <% if(spiel.actions.admin) { %>
                            <a class="feature" title="Copy to #editors">
                                <span class="icon-star-full icon"></span> <span class='text'>Feature<span>
                            </a>
                            <a class="whois" data-spiel-id="<%= spiel.spiel_id %>" title="Who is ...?">
                                <span class='icon question'>?</span>
                                <span class='text'>Who<span>
                            </a>
                            <a class="go-to" href="/all/<%= spiel.spiel_id %>" data-channel="all/<%= spiel.spiel_id %>" data-spiel-id="<%= spiel.spiel_id %>" title="What they postin?">
                                <span class='icon'>&hellip;</span> <span class='text'>Posts<span>
                            </a>
                        <% } %>
                    </td>
                </tr>
            <% } %>
        </table>

    </div>
<% } %>

<% timestamp = parseInt(spiel.timestamp); %>
<span class="date">
    <% if(spiel.timestamp) { %>
        <% if(spiel.parent_id && spiel.parent_channel && spiel.parent_timestamp) { %>
            from
            <a class="hash" href="/<%= spiel.parent_channel %>?<%= spiel.parent_id %>" data-channel="<%= spiel.parent_channel %>" data-spiel_id="<%= spiel.parent_id %>">
                <%= common.format_channel(spiel.parent_channel) %>,
                <time datetime="<%= (new Date(spiel.parent_timestamp)).toISOString() %>" timestamp="<%= spiel.timestamp %>" title="<%= common.format_datetime(spiel.parent_timestamp) %>">
                    <%= common.format_datetime(spiel.parent_timestamp) %>
                </time>
            </a>
        <% } else { %>
             <time datetime="<%= (new Date(spiel.timestamp)).toISOString() %>" timestamp="<%= spiel.timestamp %>" title="<%= common.format_datetime(spiel.timestamp) %>">
                <%= common.format_datetime(spiel.timestamp) %>
            </time>
        <% } %>
    <% } else { %>
        sending...
    <% } %>
</span>


            </script>
        
            <script type="text/html" id="notification_popup_tmpl" class="template">
                <div class="notification-popup inner" id="mail_invite_pop_up">
    <% if(!user_logged_in) { %>
        <div class="error">
            You must be logged in to subscribe for e-mail and push alerts.
        </div>
    <% } else { %>
        <div class="current-channel-subscriptions">
            <h3>Subscriptions for <em><%= current_channel[0] == "@" ? '' : '#' %><%= current_channel %></em></h3>

        <% if (!loading) { %>

            <% var watchlists_subscribed = watchlists.filter(function(watchlist){
                return watchlist.channel_in_list
            }) %>


            <% var watchlists_unsubscribed = watchlists.filter(function(watchlist){
                return !watchlist.channel_in_list
            }) %>

            <% watchlists_subscribed.forEach(function(category) { %>
                <div class='in-watchlist'>✓ Added to <%= category.name %></div><span class='remove-from-watchlist' data-id='<%- category.id %>' data-category='<%= category.name %>'><span class='icon icon-cross'></span> Remove</span><br>
            <% }); %>

            <% if (watchlists_unsubscribed.length > 0) { %>
                    <% if(selecting_watchlist) { %>
                        <form id="select-watchlist-to-subscribe">
                            <label>Choose a category:&nbsp;
                                <select class='select-watchlist'>
                                    <% watchlists
                                        .filter(function(watchlist){ return !watchlist.channel_in_list })
                                        .forEach(function(watchlist) { %>
                                        <option name='<%= watchlist.name %>' value='<%= watchlist.id %>'><%= watchlist.name %></option>
                                    <% }) %>
                                </select>
                            </label>
                            <button type="submit" class='watchlist-subscribe-button'><span class="icon icon-plus"></span> Add</button>
                        </form>
                    <% } else { %>
                        <div class='add-to-watchlist'><span class="icon icon-plus"></span> Add to watchlist</div><br />
                    <% } %>
            <% } %>

            <div class="notification-section section-email">
                <h4>Email</h4>
                <table>
                    <tr>
                        <td>
                            <input id="no-emails" class="email-radio" value="off" type="radio" name="email-radio" <% if(email_frequency === "off" || !email_frequency) { %> checked <% } %> />
                            <label for="no-emails"> Off </label>
                        </td>
                        <th rowspan="3">
                            <span class="icon-envelope notification_action"></span>
                        </th>
                    </tr>
                    <tr>
                        <td>
                            <input id="email-news" value="news" class="email-radio" type="radio" name="email-radio" <% if(email_frequency === 'news'){ %>checked <% } %> />
                            <label for="email-news"> News only</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input id="email-daily" value="daily" class="email-radio" type="radio" name="email-radio" <% if(email_frequency === 'daily'){ %>checked <% } %> />
                            <label for="email-daily">Messages &amp; news</label>
                        </td>
                    </tr>
                </table>
            </div>
            <div class="notification-section section-push">
                <h4>Push notification</h4>

                <% if(push_enabled) { %>
                     <table>  
                        <tr>
                            <td>
                                <input id="no-push" class="push-radio" value="off" type="radio" name="push-radio" <% if(push_frequency === "off" || !push_frequency) { %> checked <% } %>>
                                <label for="no-push">Off</label>
                            </td>
                            <th rowspan="3">
                                <span class="icon-mobile notification_action"></span>
                            </th>
                        </tr>
                        <tr>
                            <td>
                                <input id="news-push" class="push-radio" value="news" type="radio" name="push-radio" <% if(push_frequency === "news") { %> checked <% } %>>
                                <label for="news-push">News only</label>
                            </td>
                        </tr>    
                        <tr>
                            <td>
                                <input id="instant-push" class="push-radio" value="instant" type="radio" name="push-radio" <% if(push_frequency === "instant") { %> checked <% } %>>
                                <label for="instant-push">Messages &amp; news</label>
                            </td>
                        </tr>    
                    </table>
                <% } else { %>
                    <p class='tip'>
                        Please download our app to enable push notifications.
                        <div class="download">
                            <a href="https://itunes.apple.com/us/app/ceo.ca/id994342021"><img class="appstore" src="<%= STATIC_URL %>assets/appstore.svg" /></a>
                            <a href="https://play.google.com/store/apps/details?id=ca.ceo.chat.ceoca&hl=en"><img class="googleplay" src="<%= STATIC_URL %>assets/googleplay.svg" /></a>
                        </div>
                    </p>
                <% } %>
            </div>
            <% } else { %>
                loading...
            <% } %>
        </div>
    <% } %>
</div>

            </script>
        
            <script type="text/html" id="online_list_tmpl" class="template">
                <% if(open == true) { %>
    <div id="online-users">
        <% if (loading) { %>
            <span style="font-size:12px">loading...</span>
        <% } else { %>
            <% for (var i=0; i < online_users.length; i++) { %>
                <div class="online-user <%- online_users[i].active ? "active" : "inactive" %>" data-public-id=<%= online_users[i].public_id %>>
                    <div class="color" style="background-color:<%= online_users[i].color %>"></div>
                    <span class="name name-online-list" data-name="<%- online_users[i].name %>"><%= online_users[i].name %></span>
                </div>
            <% } %>
            <% if(offline_users.length > 0) { %>
                <% for (var i=0; i < offline_users.length; i++) { %>
                    <div class="online-user inactive offline" data-public-id=<%= offline_users[i].public_id %>>
                        <div class="color" style="background-color:<%= offline_users[i].color %>"></div>
                        <span class="name name-online-list" data-name="<%- offline_users[i].name %>"><%= offline_users[i].name %></span>
                    </div>
                <% } %>
            <% } %>
        <% } %>
    </div>
<% } %>

            </script>
        
            <script type="text/html" id="channels_tmpl" class="template">
                <%

    var format_percentage = function(percent) {
        return parseFloat(percent).toFixed(1) + "%";
    }

    var editable_types = [
        "companies",
        "people",
        "tags",
    ];

    var rename = {
        'direct_messages': 'Direct Messages',
        'private': 'Private',
        'featured': 'Featured',
        'recent': 'Recent',
        'notifications': 'Notifications',
        null: 'Uncategorized',
    };

    if(typeof quote_type === "undefined") {
        var quote_type = "%";
    }

%>

<% for(var j=0; j < channel_types.length; j++) { %>
    <%
        if(!categories[channel_types[j]]) { /*console.log("missing", channel_types[j])*/; continue; }
        var category_id = categories[channel_types[j]].id ? categories[channel_types[j]].id : channel_types[j];
        var is_watchlist_category = categories[channel_types[j]].id;
        var _channels = categories[category_id].channels ? categories[category_id].channels : categories[category_id];
        var category_name = categories[category_id].name ? categories[category_id].name : category_id;
        category_name = rename[category_name] ? rename[category_name] : category_name;
        

        if(!_channels) {
            _channels = [];
        }

        // fix sortings
        if (category_id == "featured") {
        } else if(["notifications", "private", "panels", "direct_messages"].indexOf(category_id) != -1) {
            _channels.sort(function(a, b) {
                if (a.channel == current_channel) return -1;
                if (b.channel == current_channel) return 1;
                if (!a.last_seen && b.last_seen) return -1;
                if (a.last_seen && !b.last_seen) return 1;
                if (a.new_message_count > b.new_message_count) return -1;
                if (a.new_message_count < b.new_message_count) return 1;
                if (a.last_seen > b.last_seen) return -1;
                if (a.last_seen < b.last_seen) return 1;
                return 0;
            });
        }
    %>
    <% if(_channels.length > 0 || (logged_in && (context.edit || editable_types.indexOf(category_id) != -1))) { %>
        <div class="section channels" data-type="<%= category_id ? category_id : "" %>">
            <% if(context.edit) { %>
                <% if(_channels.length > 0) { %>
                    <!-- <div class="configure settings" data-id="<%= category_id %>"><span class="icon icon-cog"></span></div> -->
                <% } else { %>
                    <div class="configure remove-category" data-id="<%= category_id %>"><span class="icon icon-cross"></span></div>
                <% } %>
            <% } %>
            <% if(category_id != "defaults") { %>
                <h3 <%- (context.edit && category_id) ? 'class="editable" contenteditable' : '' %> data-id="<%= category_id %>">
                    <% if(category_id && is_watchlist_category) { %><span class='edit-category-settings'><span class='icon icon-cog'></span></span><% }%><%= category_name %>
                    <% if(category_id == "notifications") { %>
                        <span class='clear'>clear all</span>
                    <% }%>
                </h3>
            <% } %>
            <% var limit = 4; %>
            <% var collapsable = ( _channels.length - _channels.slice(0,limit).length > 1 ) %>

            <div class="list">
                <% for(var i=0; i < (collapsed[category_id] && collapsable ? _channels.slice(0,limit).length : _channels.length); i++) { %>
                    <% var itemdata = {
                        user: context.user,
                        channel_item: _channels[i],
                        current_channel: context.current_channel,
                        show_titles: context.show_titles,
                        quote_type: context.quote_type,
                        logged_in: context.logged_in,
                        category_id: category_id,
                    } %>
                    <%- (typeof t !== 'undefined') ? t.render('partials/channel_item.html', itemdata) : Template("channel_item_tmpl", itemdata) %>
                <% } %>

                <% if (context.logged_in && _channels.length > limit && collapsed[category_id] !== undefined && collapsable ) { %>
                    <% if (!collapsed[category_id]) { %>
                        <span class="sidebar-collapse button"><span class='small-arrow icon-chevron-up'></span> less</span>
                    <% } %>
                    <% if (collapsed[category_id]) { %>
                        <span class="sidebar-reveal button"><span class='small-arrow icon-chevron-down'></span> <%= _channels.length - limit %> more</span>
                    <% } %>
                <% } %>

                <% if(logged_in && (context.edit || editable_types.indexOf(category_id) != -1)) { %>
                    <% if(typeof adding_channel_to_category != 'undefined' && adding_channel_to_category == category_id) { %>
                        <form class='add-channel-form' data-category="<%= category_id %>" autocomplete="off">
                            <span class='inline-edit-wrapper'>
                                <input type="text" class="edit typing-channel" name='query_value' placeholder="start typing" data-category="<%= category_id %>" />
                            </span>
                            <button type="button" style="display:none;"></button>
                        </form>
                    <% } else { %>
                        <span class='add-channel' data-category="<%= category_id %>"><span class="icon icon-plus"></span>Add a channel</span>
                    <% } %>
                <% } %>
            </div>
        </div>
    <% } %>
<% } %>

            </script>
        
            <script type="text/html" id="channel_item_tmpl" class="template">
                <%
    var item = context.channel_item;
    var formatting = common.get_channel_formatting(item);

    var classes = formatting.classes;
    var label = formatting.label;
    var icon = formatting.icon;

    if(item.channel.toLowerCase() === current_channel.toLowerCase()) {
        classes += " highlight";
    }
    if(logged_in && (common.is_private_channel(item.channel) || common.is_panel(item.channel)) && !item.last_seen) {
        classes += " alert";
    }

    if((category_id == "direct_messages" || common.is_direct_message_channel(item.channel)) && context.user) {
        var handle = context.user.handle ? context.user.handle : "";
        label = " " + label.substr(1, label.length-1).replace(handle.toLowerCase(), '').replace('/', '');
        classes += " dm";
        icon += " <span class='with'>with</span> ";
    }
%>
<div class="channel <%= classes %> <%= (item.channel.toLowerCase() == "gold" && category_id == 'commodities') ? 'gold' : '' %>" channel="<%= item.channel %>">
    <div class="new-count">
        <% if(item.channel != current_channel && item.new_message_count > 0) { %>
            <% if(item.new_message_count >= 50) { %>
                <%= Math.min(item.new_message_count, 50) + '+' %>
            <% } else { %>
                <%= item.new_message_count %>
            <% } %>
        <% } %>
    </div><a class="go-to" data-channel="<%= item.channel %>" href="/<%= item.channel %>"><%- icon %><%= label %>
        <% if(item.quote) { %>
            <%
                var arrow = "<span class='icon-arrow-" + (item.quote.direction == "down" ? "down" : "up")  + "'></span>";
            %>
            <span class='<%= item.quote.direction %>'>
                <%
                    // fix to AT LEAST two decimal places, possibly more
                    var value = item.quote.value;
                    value = parseFloat(value);
                    value = value ? (value < 0.5 ? common.format_price(value) : value.toFixed(Math.max(2, (value.toString().split('.')[1] || []).length))) : '';

                    var percent = parseFloat(item.quote.percent_change.replace("%", "").replace("+", ""));
                    percent = percent ? percent.toFixed(1) : 0;
                    percent = Math.abs(percent);
                %>
                <%- arrow %><%= quote_type == "%" ? percent+"%" : value %>
            </span>
        <% } %>
        <% if(item.company || context.show_titles) { %>
            <span class='desc'><%= item.company ? item.company : item.title %></span>
        <% } %>
    </a><% if(["direct_messages", "private", "recent", "notifications"].indexOf(category_id) != -1) { %><div class="delete">&times;</div><% } %>
</div>



            </script>
        
            <script type="text/html" id="watchlist_tmpl" class="template">
                <%

    var format_percentage = function(percent) {
        return parseFloat(percent).toFixed(1) + "%";
    }

    var channel_types = channel_categories.map(function(cat){ return cat.id });
    var categories = {};
    channel_categories.forEach(function(cat){
        categories[cat.id] = cat;
    });

    if(context.collapsed === undefined) context.collapsed = {}
%>

<% for(var j=0; j < channel_types.length; j++) { %>
    <%
        if(!categories[channel_types[j]]) { /*console.log("missing", channel_types[j])*/; continue; }
        var category_id = categories[channel_types[j]].id ? categories[channel_types[j]].id : channel_types[j];
        var _channels = categories[category_id].channels ? categories[category_id].channels : categories[category_id];
        var category_name = categories[category_id].name ? categories[category_id].name : category_id;

        if(category_id == 'defaults') {
            category_name = 'Featured channels';
        }
        
        if(!_channels) {
            _channels = [];
        }

    %>
    <% if(_channels.length > 0 || (context.logged_in && context.edit)) { %>
        <div class="section channels" data-type="<%= category_id ? category_id : "" %>">
            <% if(category_id && context.edit) { %>
                <span class="settings">
                    <% if(_channels.length > 0) { %>
                        <div class="privacy" data-id="<%= category_id %>"><span class="icon icon-cog"></span> Settings</div>
                    <% } else { %>
                        <div class="remove-category" data-id="<%= category_id %>"><span class="icon icon-cross"></span> Remove</div>
                    <% } %>
                </span>
            <% } %>
            <% if(category_id != "Commodities") { %>
                <% if(context.edit && category_id) { %>
                    <div class='handle' title='Click and hold to drag &amp; reorder'>↕</div>
                <% } %>
                <h3 <%- (context.edit && category_id) ? 'class="editable" contenteditable' : '' %> data-id="<%= category_id %>">
                    <%= category_name %>
                    <% if(category_id && !context.edit && categories[category_id].privacy) { %>
                        <% var privacy = categories[category_id].privacy == "off" ? 'settings' : categories[category_id].privacy %>
                        <span class="settings">
                            <span class="action privacy" data-id="<%= category_id %>"><span class='icon icon-cog'></span><%= privacy %></span> &nbsp;&nbsp;
                            <span class="action edit" data-id="<%= category_id %>"><span class='icon icon-pencil'></span>edit</span>
                        </span>
                    <% } %>
                </h3>
            <% } %>
            <% var limit = 4; %>
            <% var collapsable = ( _channels.length - _channels.slice(0,limit).length > 1 ) %>

            <div class="list">
                <!--
                <% for(var i=0; i < (collapsed[category_id] && collapsable ? _channels.slice(0,limit).length : _channels.length); i++) { %>
                    <%
                        var item = _channels[i];
                        var formatting = common.get_channel_formatting(item);

                        var classes = formatting.classes;
                        var label = formatting.label;
                        var icon = formatting.icon;

                        if(item.type == 'watchlist') {
                            if(item.title) label = item.title;
                            icon = '<span class="icon icon-th-list"></span> ';
                        }

                        if(item.channel.toLowerCase() === current_channel.toLowerCase()) {
                            classes += " highlight";
                        }
                        if(context.logged_in && (common.is_private_channel(item.channel) || common.is_panel(item.channel)) && !item.last_seen) {
                            classes += " alert";
                        }

                        if((category_id == "direct_messages" || common.is_direct_message_channel(item.channel)) && context.user) {
                            var handle = context.user.handle ? context.user.handle : "";
                            label = " " + label.substr(1, label.length-1).replace(handle.toLowerCase(), '').replace('/', '');
                            classes += " dm";
                            icon += " <span class='with'>with</span> ";
                        }
                    %>
                    --><div class="channel <%= classes %> <%= (category_id == 'Commodities') ? 'commodity' : '' %>" channel="<%= item.channel %>">
                        <a class="<%= context.edit ? '' : 'go-to' %>" data-channel="<%= item.channel %>" <% if(!context.edit) { %> href="/<%= item.channel %>" <% } %>>
                            <% if(item.quote) { %>
                                <div>
                                    <span class='channel-name cashtag'><%= label %></span>
                                    <% if(item.company || (item.title && context.show_titles)) { %>
                                        <span class='desc'><%= item.company ? item.company : item.title %></span>
                                    <% } %>
                                </div>
                                <div class='quote'>
                                    <%
                                        var arrow = "<span class='icon-arrow-" + (item.quote.direction == "down" ? "down" : "up")  + "'></span>";
                                        // fix to AT LEAST two decimal places, possibly more
                                        var value = item.quote.value;
                                        value = parseFloat(value);
                                        var orig_value = value;
                                        value = common.auto_format_price(value);

                                        var percent = parseFloat(item.quote.percent_change.replace("%", "").replace("+", "").replace("-", ""));
                                        percent = percent ? percent.toFixed(1) : 0;

                                        var price_change = parseFloat(item.quote.price_change);
                                        price_change = common.auto_format_price(price_change);
                                    %>
                                    <span class='price'>
                                        <%= value %>
                                    </span>
                                    <span class='<%= item.quote.direction %>'>
                                        <%- arrow %><span class='price-change'><%= price_change %></span> <span class='percent'><%= percent+"%" %></span>
                                    </span>
                                    <% if(item.quote.bid && item.quote.ask) {%>
                                        <div class='bid-ask'>
                                            <div class='ask'>Ask <%= common.auto_format_price(item.quote.ask.price) %> <span class='vol'>&times;<%= item.quote.ask.volume %></span></div>
                                            <div class='bid'>Bid <%= common.auto_format_price(item.quote.bid.price) %> <span class='vol'>&times;<%= item.quote.bid.volume %></span></div>
                                            <div class='volume'><span>Vol</span> <%= common.number_formatter(parseInt(item.quote.volume), 2) %></div>
                                        </div>
                                    <% } %>
                                </div>
                            <% } else { %>
                                <span class='channel-name'><%- icon %><%= label %></span>
                            <% } %>
                            <div class="new-count" title="New message count - Click to clear">
                                <% if(item.channel != current_channel && item.new_message_count > 0) { %>
                                    <% if(item.new_message_count >= 50) { %>
                                        <%= Math.min(item.new_message_count, 50) + '+' %>
                                    <% } else { %>
                                        <%= item.new_message_count %>
                                    <% } %>
                                <% } %>
                            </div>
                        </a>
                        <% if(context.logged_in && context.edit) { %>
                            <div class="delete">&times;</div>
                        <% } %>
                    </div><!--

                <% } %>
                -->

                <% if (_channels.length > limit && collapsed[category_id] !== undefined && collapsable ) { %>
                    <% if (!collapsed[category_id]) { %>
                        <span class="sidebar-collapse button"><span class='small-arrow icon-chevron-up'></span> less</span>
                    <% } %>
                    <% if (collapsed[category_id]) { %>
                        <span class="sidebar-reveal button"><span class='small-arrow icon-chevron-down'></span> <%= _channels.length - limit %> more</span>
                    <% } %>
                <% } %>

                <% if(context.logged_in && context.edit) { %>
                    <% if(typeof adding_channel_to_category != 'undefined' && adding_channel_to_category == category_id) { %>
                        <form class='add-channel-form' data-category="<%= category_id %>" autocomplete="off">
                            <span class='inline-edit-wrapper'>
                                <input type="text" class="edit typing-channel" name='query_value' placeholder="start typing" data-category="<%= category_id %>" />
                            </span>
                            <button type="button" style="display:none;"></button>
                        </form>
                    <% } else { %>
                        <span class='add-channel' data-category="<%= category_id %>"><span class="icon icon-plus"></span>Add a channel</span>
                    <% } %>
                <% } %>
            </div>
            <% if(context.edit) { %>
                <div class='sort-alphabetically' data-category_id="<%= category_id %>">Sort alphabetically</div>
            <% } %>
        </div>
    <% } %>
<% } %>


            </script>
        
            <script type="text/html" id="modal_tmpl" class="template">
                <div class="cover" id="<%= id %>">
    <div id="<%= id %>-modal" class="modal generic">
    	<div class="outer">
	        <div class="header"> <%= title %> </div>
            <% if(context.layout == 'default') { %>
                <div class="inner scroll-xy container">
                    <%- Template( template_name+'_tmpl', template_data ) %>
                </div>
            <% } else { %>
                <div class="container">
                    <%- Template( template_name+'_tmpl', template_data ) %>
                </div>
            <% } %>
	        <div class="close">&times;</div>
        </div>
    </div>
</div>

            </script>
        
            <script type="text/html" id="post_tmpl" class="template">
                <%
    var unpostable_channels = {
        'feed': {
            'message': "This feed combines messages from your subscriptions.",
        },
        'newsroom': {
            'message': "This channel is for news releases.",
        },
        'featured': {
            'message': "This channel is for editor's picks and CEO.CA sponsors.",
        },
        'popular': {
            'message': "This channel is for posts with 4 or more votes.",
        },
        'articles': {
            'message': 'This channel is for published articles.',
        },
        'all': {
            'message': 'This channel shows all public messages sent throughout the site.',
        },
        'all-private': {
            'message': 'This channel shows all private messages.',
        },
        'bookmarks': {
            'message': 'This channel is for bookmarked messages. Click on a message to reveal the bookmark button.'
        },
    }

    var can_post = (
        !banned &&
        !unpostable_channels[channel] &&
        !(common.is_panel(channel) && role == "spectator")
    );
%>
<% if(!context.filters) { %>
    <div class='outer <%= can_post ? 'enabled' : 'disabled' %>'>
        <div class='inner'>
            <% if(logged_in) { %>
                <% if(banned) { %>
                    <div class='unpostable'>You have been banned from posting to this channel.</div>
                <% } else if(unpostable_channels[channel]) { %>
                    <div class='unpostable'><%= unpostable_channels[channel].message %></div>
                <% } else if(common.is_panel(channel) && role == "spectator") { %>
                    <div class='unpostable'>Only panel members are allowed to post in this channel.</div>
                <% } else if(!user_verified) { %>
                    <div class='unpostable'>Your account must be verified before you can post.</div>
                <% } else { %>
                    <form action='/post' id="submit-spiel">
                        <span class='color' id='my-color' style='background-color: <%= color %>;'></span>
                        <%
                            var username;
                            var needs_handle;
                            var user_is_noob = (common.now() - user.timestamp < 1000*60*60*24*30*6) || user.reputation == "bad";
                            if(user_is_noob) {
                                if(user.handle) {
                                    username = user.handle;
                                    needs_handle = false;
                                } else {
                                    username = '';
                                    needs_handle = true;
                                }
                            } else {
                                username = user.name;
                                needs_handle = false;
                            }
                        %>
                        <input type='text' name='name' id='name' class='<%= (user_is_noob && !user.handle) ? "action claim" : (user_is_noob ? "force-username" : "") %>' value='<%= username %>' placeholder='<%= user_is_noob ? "Choose a name" : "Name (optional)" %>' /><span class='open-panel'>▲</span>
                        <input type='hidden' name='session' value='' />
                        <input type='hidden' name='channel' value='' />
                        <% var type_message = (user_is_noob && !user.handle) ? "You must get a handle before posting messages" : "Type your message" %>
                        <textarea <%= needs_handle ? 'disabled' : "" %> name='spiel' id='type-here' placeholder="<%= type_message %>"><%= text %></textarea>
                        <button type='submit' class='submit' id='submit' title='Send message'><span class="icon-arrow-right-alt1"></span></button>
                        <% if(user_verified) { %>
                            <a class='upload icon-files-empty' title='Upload a file'></a>
                            <input type='file' id='file-upload' style='display: none;' value="upload" />
                        <% } %>
                    </form>
                <% } %>
            <% } else { %>
                <div class='unpostable'><span class='signup-now'>Sign up</span> to become a contributing member of the community.</div>
            <% } %>

        </div>

        <% if(user) { %>
            <div class='panel' style="display: none;">
                <% if(user.handle) { %>
                    <p>Your claimed user handle is <a href="" class="hash" data-channel="<%= user.handle %>"><%= user.handle %></a>.</p>
                    <a class="action use">Use <%= user.handle %></a>
                    <p style="font-style: italic; font-size: 0.9em;">
                        You may still go anonymous if your account is older than 6 months.
                    </p>
                <% } else { %>
                    <p>You have not reserved your username yet.</p>
                    <p>Claim your username to start posting, and prevent others from using <%= (user && user.name) ? 'the name ' + user.name : 'your name' %>.</p>
                    <a class="action claim">Claim your username</a>
                <% } %>

                <a class="close">&times;</a>
            </div>
        <% } %>
    </div>
<% } %>

            </script>
        
            <script type="text/html" id="home_tmpl" class="template">
                
<% if(current_channel == "") { %>
    <div class='scroll'>
        <div class='inner'>
            <div class='intro'>
                <h1>Mobile Investment Conference</h1>
                <div class='sub-2'>
                    Share knowledge and track stocks in real-time among CEOs and market pros.
                    <div class='online-count'><span class='icon icon-users'></span> <span class='number'><%= users_online %> user<%= (users_online == 1) ? '' : 's' %></span> online</div>
                </div>
            </div>
            <div class='tabs'>
                <% var tabs = ['Featured', 'Watchlist', 'Movers', 'Active', 'Popular', 'News', 'Leaderboards']; %>
                <% tabs.forEach(function(t) { %>
                    <div class='tab <%= t == context.tab ? "selected" : "" %>'>
                        <%= t %>
                    </div>
                <% }); %>
            </div>
            <div class='content'>
                <% if(context.loading) { %>
                    <div class='loading'>
                            Loading...
                    </div>
                <% } else { %>
                    <% if(context.tab == 'Featured') { %>
                        <div class='watchlist'>
                            <div class='channels-list public detailed narrow'>
                                <% 
                                    var state = {
                                        current_channel: current_channel,
                                        collapsed: {},
                                        logged_in: logged_in,
                                        admin: admin,
                                        channel_categories: channel_categories,
                                        quote_type: context.sidebar_settings.quote_type,
                                    };
                                %>
                                <%- (typeof t !== 'undefined') ? t.render('partials/watchlist.html', state) : Template("watchlist_tmpl", state) %>
                            </div>
                            <% if(context.discover) { %>
                                <div class='discover'>
                                    <%- (typeof t !== 'undefined') ? t.render('partials/discover_inner.html', discover) : Template("discover_inner_tmpl", discover) %>
                                </div>
                            <% } %>
                        </div>
                    <% } else if(context.tab == 'Watchlist') { %>
                        <div id='watchlist' class='watchlist'>
                            <% if(context.watchlist) { %>
                                <h2 class='watchlist-save'>
                                    Your Watchlists
                                    <% if(context.edit) { %>
                                        <span class='action cancel'>
                                            Cancel
                                        </span>
                                        <span class='action done'>
                                            <span class='icon'>✓</span> Save
                                            <% if(context.saving) { %>
                                                (saving...)
                                            <% } %>
                                        </span>
                                    <% } else if(context.logged_in) { %>
                                        <span class='action edit'><span class='icon icon-pencil'></span> Edit</span>
                                    <% } else { %>
                                        <span class='action signup-now'><span class='icon icon-plus'></span> Sign up to customize</span>
                                    <% } %>
                                </h2>
                                <div class='spacer'></div>
                                <% if(context.edit) { %>
                                    <div class='text'>Drag &amp; drop companies &amp; categories to customize the order.</div>
                                <% } %>
                                <% if(!context.edit && context.watchlist.length == 0) { %>
                                    <div class="text">Your watchlist is empty.</div>
                                <% } %>
                                <div class='channels-list detailed <%= context.edit ? 'edit' : '' %>'>
                                    <% if(context.edit) { %>
                                        <div class='add-category'><span class='icon icon-plus'></span> Add a category</div>
                                    <% } %>
                                    <% 
                                        var state = {
                                            current_channel: context.current_channel,
                                            collapsed: {},
                                            logged_in: context.logged_in,
                                            admin: context.admin,
                                            channel_categories: watchlist,
                                            quote_type: context.sidebar_settings.quote_type,
                                            edit: context.edit,
                                            adding_channel_to_category: context.adding_channel_to_category,
                                            show_titles: true,
                                        };
                                    %>
                                    <%- (typeof t !== 'undefined') ? t.render('partials/watchlist.html', state) : Template("watchlist_tmpl", state) %>
                                    <% if(context.edit && watchlist.length > 0) { %>
                                        <div class='add-category'><span class='icon icon-plus'></span> Add a category</div>
                                    <% } %>
                                </div>
                            <% } %>
                        </div>
                    <% } else if(context.tab == 'Active' || context.tab == 'Popular' || context.tab == 'Movers') { %>
                        <div class='watchlist'>
                            <% if(!context.loading) { %>
                                <div class='channels-list detailed'>
                                    <% 
                                        var state = {
                                            current_channel: current_channel,
                                            collapsed: {},
                                            logged_in: logged_in,
                                            admin: admin,
                                            channel_categories: channel_categories,
                                            quote_type: context.sidebar_settings.quote_type,
                                            show_titles: true,
                                        };
                                    %>
                                    <%- (typeof t !== 'undefined') ? t.render('partials/watchlist.html', state) : Template("watchlist_tmpl", state) %>
                                </div>
                            <% } %>
                        </div>
                    <% } else if(context.tab == 'News') { %>
                        <div class='news discover'>
                            <%
                                discover.categories = [
                                    {key: "recent_news", title: "Recent & relevant to CEO.CA",},
                                    {key: "watchlist_news", title: "News from your watchlists",},
                                    {key: "popular_news", title: "Popular news of the week",},
                                ];
                            %>
                            <%- (typeof t !== 'undefined') ? t.render('partials/articles.html', discover) : Template("articles_tmpl", discover) %>
                        </div>
                    <% } else if(context.tab == 'Leaderboards') { %>
                        <%- (typeof t !== 'undefined') ? t.render('partials/leaderboard.html', context) : Template("leaderboard_tmpl", context) %>
                    <% } %>
                <% } %>
            </div>
        </div>
    </div>
    <% if(context.edit) { %>
        <div class='floating-buttons watchlist-save'>
            <span class='action cancel'>
                Cancel
            </span>
            <span class='action done'>
                <span class='icon'>✓</span> Save
            </span>
        </div>
    <% } %>
<% } %>

            </script>
        
            <script type="text/html" id="nav_tmpl" class="template">
                
                <%

                    var item = {
                        type: stock_info ? "cash" : "",
                        channel: current_channel,
                    }

                    var formatting = common.get_channel_formatting(item);

                %>
                <div class='tab <%= current_tab == "left-sidebar" ? "current" : "" %> toggle-left-sidebar'>
                    <div class="shadow"></div>
                    <div class="shadowed">
                        <svg viewBox="0 0 5 40">
                            <path d="M0,40 L5,5 L5,40 L0,40" />
                        </svg></div><div class='label'><%
                            
                            if(context.stock_info) { %><span class="icon icon-stats-dots"></span> <%= stock_info.company %><% }
                            else if(common.is_shared_watchlist_channel(current_channel)) { %><span class="icon icon-th-list"></span> Watchlist<% }
                            else if(common.is_handle(current_channel) && !common.is_article(current_channel)) { %><span class="icon icon-users"></span> Profile<% }
                            else { %><span class="icon icon-newspaper-o"></span> Articles<% }
                        %>
                    </div><div class="shadowed">
                        <svg viewBox="0 0 5 40">
                            <path d="M0,5 L5,40 L0,40 L0,5" />
                        </svg>
                    </div>
                </div><div class='tab <%= current_tab == "chat" ? "current" : "" %> toggle-chat'>
                    <div class="shadow"></div>
                    <div class="shadowed">
                        <svg viewBox="0 0 5 40">
                            <path d="M0,40 L5,5 L5,40 L0,40" />
                        </svg></div><div class='label'>
                        <span class='channel'>
                            <%- formatting.icon ? formatting.icon : '' %><%= formatting.label %>
                        </span> channel
                    </div><div class="shadowed">
                        <svg viewBox="0 0 5 40">
                            <path d="M0,5 L5,40 L0,40 L0,5" />
                        </svg>
                    </div>
                </div>

            </script>
        
            <script type="text/html" id="sidebar_tmpl" class="template">
                <div class="scroll main">

    <div class="default-channels column">
        <div class="padding">
            <div class="section">
                <% if(!sidebar.logged_in) { %>
                    <span class="button" id="login"><span class="icon icon-key"></span>Log in</span><br />
                    <span class="button" id="signup"><span class="icon icon-plus"></span>Sign up</span><br />
                <% } %>
                <!--<span class="button open-search"><span class="icon icon-search"></span>Search</span><br />-->
                <% if(sidebar.logged_in) { %>
                    <span class="button new-channel open-start-channel"><span class="icon icon-arrow-right-alt1"></span>Find / Start a channel</span><br />
                <% } %>
                <% if(sidebar.logged_in && sidebar.user.verified == "VERIFIED") { %>
                    <span class="button open-my-articles"><span class="icon icon-pencil"></span>My articles</span><br />
                <% } %>
                </div>
            </div>

            <div id="channels-inner">
                <%- (typeof t !== 'undefined') ? t.render('partials/sidebar_channels.html', sidebar) : Template("sidebar_channels_tmpl", sidebar) %>
            </div>

            <% if(sidebar.logged_in) { %>
                <div class="section logout">
                    <div class="inner" style="margin: 5px 25px 10px 25px;">
                        You are logged in as <%= sidebar.logged_in %>
                        <span style='margin-top: 10px;' id='open-settings' class='settings-switch'><span class='icon icon-cog'></span> Account Settings</span>
                    </div>
                    <a href="#" class="button open-pro-manager">Pro subscription</a><br />
                    <% if (sidebar.admin) { %>
                        <a href="#" class="button" id="admin-open-admin-panel">Admin Panel</a><br />
                    <% } %>
                    <a href="/api/logout" class="button" id="logout">Logout</a>
                </div>
            <% } %>
        </div>
    </div>

    <div class="header">
        <span class="show-all-channels">
            Personal channels
        </div>
    </div>
</div>

            </script>
        
            <script type="text/html" id="sidebar_channels_tmpl" class="template">
                
<% var channel_types = ['defaults', 'notifications', 'featured', 'direct_messages', 'private', 'recent']; %>

<% var data = {
    channel_types: channel_types,
    categories: categories,
    collapsed: collapsed,
    current_channel: current_channel,
    admin: admin,
    logged_in: logged_in,
    quote_type: quote_type,
    user: user,
} %>
<%- (typeof t !== 'undefined') ? t.render('partials/channels.html', data) : Template("channels_tmpl", data) %>

<% if(context.watchlist && context.watchlist.length > 0) { %>
    <%
        var watchlist_object = {};
        context.watchlist.forEach(function(w){
            watchlist_object[w.id] = w;
        });
        var watchlist_keys = context.watchlist.map(function(w){ return w.id });
    %>
    <% 
        var state = {
            current_channel: context.current_channel,
            collapsed: collapsed,
            logged_in: context.logged_in,
            admin: context.admin,
            categories: watchlist_object,
            channel_types: watchlist_keys,
            quote_type: context.quote_type,
            user: user,
        };
    %>
    <%- (typeof t !== 'undefined') ? t.render('partials/channels.html', state) : Template("channels_tmpl", state) %>
<% } %>


            </script>
        
            <script type="text/html" id="spiel_actions_tmpl" class="template">
                
            </script>
        
            <script type="text/html" id="search_suggestions_tmpl" class="template">
                
<% var channel_types = [
    "tags",
]; 

var default_categories = {
    tags: []
}

for(var key in categories) {
    default_categories[key] = categories[key];
}

%>

<% var data = {
    channel_types: channel_types,
    current_channel: '',
    collapsed: {},
    categories: default_categories,
    admin: false,
    adding_channel_to_category: null,
    logged_in: false,
    expanded: true,
} %>
<% if(query) { %>
    <div class="channels-list highlight-first">
        <%- (typeof t !== 'undefined') ? t.render('partials/channels.html', data) : Template("channels_tmpl", data) %>
        <div class='channel special search-messages'>
            <a data-query='<%= query %>'><span class="icon icon-bubbles2"></span> Search public messages</a>
        </div>
        <% if(context.logged_in) { %>
            <div class='channel special search-private-messages'>
                <a data-query='<%= query %>'><span class="icon icon-lock"></span> Search private messages</a>
            </div>
        <% } %>
    </div>
<% } else { %>
    <div class="channels-list highlight-first">
        <%- (typeof t !== 'undefined') ? t.render('partials/channels.html', data) : Template("channels_tmpl", data) %>
    </div>
    <div class='loading'>Loading...</div>
<% } %>

            </script>
        
            <script type="text/html" id="deep_link_tmpl" class="template">
                <div class="deep_link pop-up-share" id="deep_link">
	<span class="exit">&times;</span>
	share a link to this message
	<br>
    <% if(!link) { %>
        <input id="share-url" type="text" style="display:block; width:100%;" value="<%=base_url %>/<%=channel%>?<%=spiel_id%>">
    <% }else{ %>
        <input id="share-url" type="text" style="display:block; width:100%;" value="<%= link %>">
    <% } %>
</div>

            </script>
        
            <script type="text/html" id="votes_tmpl" class="template">
                <!-- <div class='vote'>
	<span class='vote-count'><%=vote_count%></span>
	<span class='icon-thumbsup'</span>
</div> -->

            </script>
        
            <script type="text/html" id="stock_chart_tmpl" class="template">
                <div class='history-chart-container widget'>

    <div class='padding <%- collapsed ? 'collapsed' : 'fullsize' %>'>

        <div class="data-box">
                <% var data = {
                    symbol: symbol,
                    company: company,
                    url: url,
                    quote: quote || null,
                    collapsed: collapsed,
                } %>
                <%- (typeof t !== 'undefined') ? t.render('partials/stock_chart_data.html', data) : Template("stock_chart_data_tmpl", data) %>
        </div>

    </div>

    <div class="chart noselect">
    </div>

    <% if(!collapsed) { %>
        <div class="chart-buttons">
            <div class="chart-button 1d">1d</div><div class="chart-button 1w">1w</div><div class="chart-button 1m">1m</div><div class="chart-button 3m">3m</div><div class="chart-button chart-button-focussed 1y">1y</div><div class="chart-button chart-button-inactive 3y MAX">3y</div>
        </div>

    <% } %>
    <div class="data-box2">
        <%- (typeof t !== 'undefined') ? t.render('partials/stock_chart_data2.html', data) : Template("stock_chart_data2_tmpl", data) %>
    </div>
</div>

<% 
    var has_lvl2 = common.symbol_has_lvl2(symbol);
    var allowed = (context.pro && context.allowed_exchanges.indexOf(common.exchange_code_for_symbol(symbol)) != -1 && has_lvl2) || (!context.pro && common.symbol_is_cse(symbol));
%>
<% if(context.pro || common.symbol_is_cse(symbol)) { %>
    <div class="note widget hidden">
        <div class="padding">
            <h3>Market Depth</h3>
            <div class='text'>
                <% var exchanges = {V: 'TSX Venture', TO: 'TSX', CN: 'CSE'}; %>
                Market depth is not enabled for <%= exchanges[common.exchange_code_for_symbol(symbol)] %>.
                <br /><a>Get CEO.CA Pro</a> to gain access.
            </div>
        </div>
    </div>
    <div id="market-depth-chart-table" class="widget <%= (allowed) ? '' : 'hidden'%>">
        <div class="padding">
            <h3 class='hidden'>
                Market Depth
                <div class="chart-table-toggle hidden">
                    <span class="mode current market-depth-chart-toggle">
                        <span class="icon icon-stats-dots"></span> Chart
                    </span>
                    <span class="mode market-depth-table-toggle">
                        <span class="icon icon-th-list"></span> Tables
                    </span>
                </div>
            </h3>
        </div>
        <div class="market-depth-chart noselect">
            <div class='delayed <%= (context.allowed_exchanges.indexOf(common.exchange_code_for_symbol(symbol)) != -1)  ? "hidden" : "" %>'>15 min. delayed<br /><a href='/about/market-depth' class='unlock' target="_blank">Enable Real-Time</a></div>
            <div class="controls">
                <a title='Scroll up' class='scrollup'><span class='icon icon-chevron-up'></span></a>
                <a title='Back to center' class='scrollcenter'><span class='icon'>•</a></a>
                <a title='Scroll down' class='scrolldown'><span class='icon icon-chevron-down'></span></a>
            </div>
            <div class="legend padding <%= (context.pro) ? '' : 'hidden' %>">
                <div class='left'>
                    <div>
                    <span class="box volume"></span> Volume
                    </div>
                </div>
                <div class='right'>
                    <div>
                        <span class="box bid"></span> Bids
                        &nbsp;
                        <span class="box ask"></span> Asks
                    </div>
                    <div>
                        Darker means older
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="market-depth-tables <%= (allowed) ? '' : 'hidden'%>">
        <%- (typeof t !== 'undefined') ? t.render('partials/market_depth_tables.html', data) : Template("market_depth_tables_tmpl", data) %>
    </div>
<% } %>


            </script>
        
            <script type="text/html" id="stock_chart_data_tmpl" class="template">
                    <div class="fullname hidden">
        <%= company ? company : '' %>
        <span class="symbol">
            <%= symbol ? symbol : '' %>
        </span>
    </div>



    <% if (quote) { %>
        <div class='quote'>
            <%
                var value = parseFloat(quote.last_trade_price ? quote.last_trade_price : 0)
                var last_trade = value ? value.toFixed(Math.max(2, (value.toString().split('.')[1] || []).length)) : '';
            %>
            <span class="last-value"><%= last_trade %></span>

            <%
                var chvalue = parseFloat(quote.price_change);
                var change = common.auto_format_price(chvalue);
            %>
            <span class='<%= quote.direction %>'>
                <span class='icon-arrow-<%= quote.direction == "down" ? "down" : "up"  %>'></span><%= change %>
                <span class='percent'><%= quote.percent_change ? parseFloat(quote.percent_change).toFixed(1) +"%" : '' %></span>
            </span>
            <div class="last-trade"><%= quote.date %> <%= quote.time %></div>
            <div class="timeliness <%= quote.realtime ? 'realtime' : 'delayed' %>"><%= quote.realtime ? 'Real-time' : '15 min. delayed' %></div>
        </div>
    <% } %>

            </script>
        
            <script type="text/html" id="stock_chart_data2_tmpl" class="template">
                
    <% if (quote) { %>
        <div class='details'>
            <table>
                <tr>
                    <th>Mkt Cap</th>
                    <td><%= quote.market_cap ? common.number_formatter(parseInt(quote.market_cap), 2) : 'N/A' %></td>
                    <th>Shares</th>
                    <td><%= (quote && quote['SharesOutstanding']) ? quote['SharesOutstanding'] : 'N/A' %></td>
                </tr>
                <tr>
                    <th>Volume</th>
                    <td><%= quote.volume ? common.number_formatter(parseInt(quote.volume), 2) : 'N/A' %></td>
                    <th>Shorts</th>
                    <td>
                        <%= quote.short_volume !== undefined ? common.number_formatter(parseInt(quote.short_volume), 2) : 'N/A' %>
                        <% if (quote.short_volume !== undefined && common.symbol_is_tsx(symbol)) { %>
                            <a href='#' id="open-short-positions" data-symbol="<%- symbol %>"> <span class='icon house-pos icon-file-text'></span> history</a>
                        <% } %>
                    </td>
                </tr>
                <tr>
                    <th>Avg. volume</th>
                    <td><%= quote.average_daily_volume ? common.number_formatter(parseInt(quote.average_daily_volume), 2) : 'N/A' %></td>
                    <th></th>
                    <td>
                    </td>
                </tr>
                <tr>
                    <th>Website</th>
                    <td>
                        <% if (url) { %>
                            <% var short_url = url.replace('http://', '').replace('https://','').replace('www.',''); %>
                            <a class="action company-url" target="_blank" href="<%- url %>"><%= short_url %></a>
                        <% } else { %>
                             N/A
                        <% } %>
                    </td>
                    <th>Insiders</th>
                    <td>
                        <% if(common.symbol_is_canadian(symbol)) { %>
                            <a class="action sedi" data-channel="<%= symbol ? symbol.split('.')[0] : '' %>"><span class='icon sedi icon-file-text'></span>SEDI:<%= symbol ? symbol.split('.')[0] : '' %></a>
                        <% } else { %>
                             N/A
                        <% } %>
                    </td>
                </tr>
                <!--
                <tr>
                    <th>Units</th>
                    <td><%= quote.units ? quote.units : '' %></td>
                </tr>
                -->
            </table>
        </div>
    <% } %>

            </script>
        
            <script type="text/html" id="stock_search_tmpl" class="template">
                <table class="<%= namespace %> symbol_search_results">
    <% for (var i=0; i < results.length; i++) { %>

        <%
            var symbol = results[i].symbol
            var company = results[i].name

        %>
        <% if(for_ticker) { %>
            <tr>
                <td>$<span><%= symbol %></span></td>
                <td><%= company %></td>
            </tr>
        <% } else { %>
            <tr>
                <td>$<span><%= symbol %></span><span style="display:block"> <%=company %></span></td>
            </tr>
        <% } %>    
    <% } %>
</table>

            </script>
        
            <script type="text/html" id="signup_tmpl" class="template">
                <div id='login-modal' class='modal generic big-buttons'>
    <div class='outer'>
        <div class="close-button">&times;</div>
        <div class='logo'></div>
        <div id="signup-box" class="scroll inner">
            <form id="registration" novalidate>
                <% if(context.referrer == "about/market-depth") { %>
                    <h1>Registration</h1>
                    <div class='sub-2'>
                        You must verify your email address before choosing your payment plan.
                    </div>
                <% } else { %>
                    <h1>Mobile Investment Conference</h1>
                    <div class='sub-2'>
                        Share knowledge and track stocks in real-time among CEOs and market pros.
                    </div>
                <% } %>
                <% if(context.referrer == "about/market-depth") {
                    var text = "Verify";
                } else {
                    var text = "Request Invite!";
                } %>
                <input type="email" name="email" required="true" placeholder="Your email" class="email registration-email" /><button type='submit' data-text="<%= text %>" id='submit-registration'>
                    <%= text %>
                </button>

                <div class="agree">
                    <label>
                        <input id="terms-checkbox" type="checkbox" name="agree" style="margin-right:10px;" />I agree to the CEO.CA <a href="/@tommy/terms-of-use" target="new">Terms of Use</a> and <a href="/@tommy/privacy-policy" target="new">Privacy Policy</a>
                    </label>
                </div>
            </form>
            <div class="actions">
                <div class="action">
                    <span class="faint">Already a member?</span>
                    <br /><a class="login-now">Log in</a> now.
                </div>
                <div class="action">
                    <span class="faint">Want to learn more?</span>
                    <br />Visit the <a target="new" href="/@tommy/about">About</a> page.
                </div>
            </div>
        </div>


        <div id="login-box" class="inner scroll" style="display:none;">
            <h1>Log in</h1>
            <form id="login-form">
                <input id="email" class="email" type="email" name="email" required="true" placeholder="email" />
                <input id="password" class="password" type="password" name="password" required="true" placeholder="password" />
                <button type='submit' id='submit-login'>Log in</button><br>

                <a id="forgot_your_password">
                    forgot your password?
                </a>
            </form>
        </div>
    </div>
</div>


            </script>
        
            <script type="text/html" id="map_tmpl" class="template">
                

<div class="cover" id="map-container">
    <div class="modal map">
        <div class="outer">
            <div class="close-button">
                &times;
            </div>
            <div class="header">
            </div>
            <div class="sub-header">
                 Featured Projects
            </div>
            <div id="map" class="inner">
                
            </div>
        </div>
    </div>
</div>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBEqes4jh-hoLhTKEN7OA8RzfK6hQpDdWc&callback=initMap"></script>


            
        
            <script type="text/html" id="map_popup_tmpl" class="template">
                <img src='<%= logo %>' />
<h2>
    <a href='/<%= symbol %>'>$<%= symbol %></a>
    <%= name %>
</h2>
<div class="location"><%= location %></div>
<div class='details'>
    <div><a href='<%= website %>'><%= website %></a></div>
    <% if(ceo) { %>
        <div><label>CEO</label> <%= ceo %></div>
    <% } %>
    <% if(commodities) { %>
        <div><%= commodities %></div>
    <% } %>
</div>

<a class='small' href='http://maps.google.com/?q=<%= latitude %>,<%= longitude %>' target='_blank'>open in Google Maps</a>


            </script>
        
            <script type="text/html" id="invite_users_tmpl" class="template">
                <div id="inviteusersinner">
    <%- (typeof t !== 'undefined') ? t.render('partials/invite_users_inner.html', state) : Template("invite_users_inner_tmpl", state) %>
</div>
            </script>
        
            <script type="text/html" id="invite_users_inner_tmpl" class="template">
                <% if (tab == 'menu') { %>
    <div id="invite-menu">
        <% if (color) { %><span class='color' style='background:<%= color %>'></span><% } %><h3 <% if (!color) { %>class="no-color"<% } %>>[<%= to_handle %>]</h3>
        <ul>
            <% if (dm) { %>
                <li class="private-message">Send a Direct Message<span class="icon icon-chevron-right"></span></li>
            <% } %>
            <li class="private-channel">Invite to Private Channel<span class="icon icon-chevron-right"></span></li>
            <li class="profile">Go to <%= to_handle %>'s Profile<span class="icon icon-chevron-right"></span></li>
        </ul>
        <% if (murat) { %>
            <h3>Chat Menu</h3>
            <ul>
                <li><input></li>
                <li>Share</li>
                <li>Manage</li>
                <li>Moderate</li>
                <li>Admin</li>
            </ul>
        <% } %>
    </div>
<% } else if (tab == 'private'){ %>
<div id="invite-private">
    <div id="back-button"><span class="icon icon-chevron-left"></div>
    <h3>Invite <%= to_handle %> to:</h3>
    <div class="input-container"><span class="icon icon-lock"></span>.<input id="new-private" type="text" placeholder="channel name" /><div id="invite-new-submit"><span class="icon icon-arrow-right-alt1"></span></div></div>
    <h3>Or an existing one:</h3>
    <ul>
        <% for (var i = 0; i < private_channels.length; i++) { %>
            <li class="invite-room" id="<%= private_channels[i] %>"><span class="icon icon-lock"></span><%= private_channels[i] %></li>
        <% } %>
    </ul>
</div>
<% } %>
            </script>
        
            <script type="text/html" id="load_more_tmpl" class="template">
                
<div class="placeholder" style="height: 40px; <%= (response.article) ? 'display: none;' : '' %>">
    <% if(response.spiels.total_spiels == 0 && !request.since && !request.until) { %>
        <div class='load-info'>No one has posted to this room yet</div>
        <a href='#' class='load-more' style='display: none;' id='load-more'><span>see older messages</span></a>
    <% } else if(response.spiels.length < response.total_spiels || request.jump_to_date) { %>
        <a href='#' class='load-more' id='load-more'><span>see older messages</span></a>
    <% } else { %>
        <div class='load-info'>No more messages to load</div>
        <a href='#' class='load-more' style='display: none;' id='load-more'><span>see older messages</span></a>
    <% } %>
</div>

            </script>
        
            <script type="text/html" id="moderator_toolbar_tmpl" class="template">
                
<div id="current-channel" class="formatted-channel">
        <span class="channel <%= channel %>">
            <%

                var item = {
                    type: stock_symbol ? "cash" : "",
                    channel: channel,
                }

                var formatting = common.get_channel_formatting(item);

            %>
            <%- formatting.icon ? formatting.icon : '' %><%= formatting.label %>
        </span>
    <div class="online action leftpad toggle <%= show_online ? 'open' : '' %>" id="num-online">
        <% if(channel != "feed" && channel != "bookmarks") { %>
            <span class="details">
                <% if(disconnected) { %>
                    connecting
                <% } else { %>
                    <span class="icon icon-users" style="font-size: 10px;"></span>
                    <%= num_online %><%= (channel != '.pros' && common.is_private_channel(channel)) ? '/'+(num_online + num_offline) : '' %> online
                <% } %>
            </span>
        <% } %>
    </div>

    <div class="controls">
        <span class='action toggle open-filters <%= context.filters_open ? 'open' : '' %>' href=''>
            <span class="icon icon-filter" style="margin-right: 4px;"></span><span class='desc'>Filters</span><% if(context.filter_open) { %><span class="icon chevron icon-chevron-up"></span><% } else { %><span class="icon chevron icon-chevron-down"></span><% } %>
        </span><!--
        --><span class='action toggle open-datepicker <%= context.datepicker_open ? 'open' : '' %>' href=''>
            <span class="icon icon-clock" style="margin-right: 4px;"></span><span class='desc'>Archives</span><% if(context.datepicker_open) { %><span class="icon chevron icon-chevron-up"></span><% } else { %><span class="icon chevron icon-chevron-down"></span><% } %>
        </span><!--
        <% if(channel == "feed" || channel == "" || channel == "all") { %>
            -->
        <% } else { %>
            --><% if(admin || common.is_panel(channel) || common.is_private_channel(channel) || role == "owner" || role == "moderator" || role == "public_moderator") { %><span class='action toggle manage <%= manage_open ? 'open' : '' %>' href=''>
                    <span class="icon icon-cog" style="margin-right: 4px;"></span><span class='desc'>Members</span><% if(manage_open) { %><span class="icon chevron icon-chevron-up"></span><% } else { %><span class="icon chevron icon-chevron-down"></span><% } %>
            </span><% } %>
            <% if (subscribable) { %>
                <span class='action toggle subscribe open-notifications <%= subscribe_open ? 'open' : '' %>' href=''>
                    <% if(subscribe_open) { %>
                        <span class="call-to-action"><span class="icon icon-minus"></span> &nbsp;&nbsp;close&nbsp;&nbsp;</span>
                    <% } else { %>
                        <span class="call-to-action"><span class="icon icon-plus"></span> subscribe</span>
                    <% } %>
                </span>
             <% } %>
        <% } %>
    </div>
</div>

<div class="expanded scroll <%- (manage_open) ? 'show' : '' %>">
    <% if (loading) { %>
        loading...
    <% } else { %>
        <div style='text-align: center;'>
            <%- (admin && !role) || (role === 'public_moderator') ? 'Moderators' : 'Members' %> of
            <% if(common.is_private_channel(channel)) { %><span class="icon-lock"></span><% } else { %><%= (channel[0] != "@") ? "#" : "" %><% } %><%= channel %>
            
            <% if((common.is_private_channel(channel) && !common.is_direct_message_channel(channel) && channel != '.pros') || (common.is_panel(channel) && role != "spectator")) { %>
                <span class="button leave"><span class="icon icon-cross"></span> Leave channel<span>
            <% } %>
        </div>
        <div class="section">
            <h5>Moderators</h5>
            <table>
                <% user_list.filter(function(user) { return (user.role == 'moderator' || user.role == 'owner'); }).forEach(function(user) { %>
                    <tr data-public-id="<%= user.public_id %>">
                        <td>
                            <span class="color" style="background:<%= user.color %>"></span>
                            <span class="name"><%= user.name %></span>
                            <span class="role"><%= user.role %></span>
                        </td>
                        <% if(role === 'owner' && user.role != 'owner') { %>
                            <td>
                                <span class="action make-owner">Make owner</span>
                            </td>
                        <% } %>
                    </tr>
                <% }); %>
            </table>
        </div>
        <div class="section">
            <h5>Members</h5>
            <table>
                <% user_list.filter(function(user) { return user.role == 'member'; }).forEach(function(user) { %>
                    <tr data-public-id="<%= user.public_id %>">
                        <td>
                            <span class="color" style="background:<%= user.color %>"></span>
                            <span class="name"><%= user.name %></span>
                        </td>
                        <% if(role === 'owner' || role === 'moderator' || role == 'public_moderator' || role == 'admin'){ %>
                            <td>
                                <span class="action kick">Kick</span>
                            </td>
                        <% } %>
                        <% if(role === 'owner') { %>
                            <td>
                                <span class="action promote">Make moderator</span>
                            </td>
                        <% } %>
                    </tr>
                <% }); %>
            </table>
        </div>
        <% if (role == 'owner' || role == 'moderator' || role == 'site_moderator' || role == 'admin'){ %>
            <div class="section">
                <h5>Invite by handle</h5>
                <form class="invite-handle invite-member">
                    <span class="inline-edit-wrapper">
                        @<input class="invite-handle-input" type="text" placeholder="handle" name="handle"/>
                    </span>
                    <button type="submit">invite</button>
                </form>
                <h5>Invite by email</h5>
                <form class="invite-user-email invite-member">
                    <span class="inline-edit-wrapper">
                        <input type="text" name="email" placeholder="email" />
                    </span>
                    <button type="submit">invite</button>
                </form>
            </div>
        <% } %>
        <% if(admin && !common.is_private_channel(channel)) { %>
            <div class="section">
                <h5>Make moderator by handle</h5>
                <form class="invite-handle make-moderator">
                    <span class="inline-edit-wrapper">
                        @<input class="invite-handle-input" type="text" placeholder="handle" name="handle"/>
                    </span>
                    <button type="submit">make moderator</button>
                </form>
                <h5>Make moderator by email</h5>
                <form class="invite-user make-moderator">
                    <span class="inline-edit-wrapper">
                        <input type="text" name="email" placeholder="email" />
                    </span>
                    <button type="submit">make moderator</button>
                </form>
            </div>
        <% } %>
    <% } %>
</div>

            </script>
        
            <script type="text/html" id="article_editor_tmpl" class="template">
                
    <div class='inner scroll-xy'>
        <div class="article-editor">

            <h1 class="title" contenteditable=true>
                <% if(loading) { %>
                    Loading...
                <% } else { %>
                    <%= title %>
                <% } %>
            </h1>

            <% if(html_editor == true) { %>
                <textarea style="width: 100%; box-sizing: border-box; height: auto;" class='editable'><% if(loading) { %>loading...<% } else { %><% if (article_html) { %><%- vkbeautify.xml(article_html) %><% } %><% } %></textarea>
            <% } else { %>
                <div class='editable'>
                    <% if(loading) { %>
                        loading...
                    <% } else { %>
                        <% if (article_html) { %>
                            <%- article_html %>
                        <% } %>
                    <% } %>
                </div>
            <% } %>

        </div>
    </div>



    <div class="article-editor-toolbar">
        <div class="slug-input">
            URL: 
            <% if (!published) { %>
                https://ceo.ca/<%= author %>/<input type="text" value='<%- slug || 'title' %>' style="width:300px;"/>
            <% } else { %>
                https://ceo.ca/<%= author %>/<%= slug %>
            <% } %>
        </div>
        <% if (published) { %>
            <span style="color: #aaa;">Your article has been published to <a href="/articles" target="_blank">#articles</a></span>
        <% } else { %>
            <% if (user && user.admin && users) { %>
                <span style="color: #666;">Author:
                    <select class="change-author">
                        <% users.forEach(function(other_user) { %>
                            <% if(other_user.handle == author) { %>
                                <option value="<%= other_user.handle %>" selected="selected"><%= other_user.handle %> (Current author)</option>
                            <% } else { %>
                                <option value"<%= other_user.handle %>"><%= other_user.handle %></option>
                            <% } %>
                        <% }); %>
                    </select>
                </span>
            <% } else { %>
                <span style="color: #aaa;">When you Publish your article, it will be posted to <a href="/articles" target="_blank">#articles</a></span>
            <% } %>
        <% } %>
        <% if(user && user.admin) { %>
            <br />
            <form style="color: #666;" class="add-tag" action="">
                Tags: <input placeholder="Tag name" name="tag" style="width: 80px" /><input type="submit" value="Add" style="width: 40px" />
                <span class="tag-list">
                    <% tags.forEach(function(tag) { %>
                        <span class="tag"><%= tag %></span>
                    <% }); %>
                </span>
            </form>
            <form style="color: #666;" class="upload-article-thumbnail" style="display:inline-block;">
                Thumbnail: <input type="file" style="width:200px;"/><input type="submit" style="width:50px" value="upload">&nbsp;<span class="upload-progress"></span>
            </form>
        <% } %>

        <div class="actions" style="position: absolute; bottom: 5px; right: 15px;">
            <% if(loading) { %>
                loading...
            <% } else { %>
                <% if (unsaved) { %>
                    <a class="save-article">save</a>
                <% } else { %>
                    <a class="save-article saved">saved!</a>
                <% } %>
                <% if (!published) { %>
                    <a class="publish-article">publish</a>
                <% } else { %>
                    <!--<a class="unpublish-article">unpublish</a>-->
                <% } %>
                <br />
                <a class="delete-article">delete</a>

                <a class="preview-article" href="/<%= author %>/<%- slug %>" target="_blank">preview</a>
            <% } %>
        </div>
    </div>

    <% if(user && user.admin) { %>
        <div class="toggle-html-editor"><%= html_editor ? "Visual editor" : "Edit as HTML" %></div>
    <% } %>

            </script>
        
            <script type="text/html" id="article_tmpl" class="template">
                <div id="article" class="<%= (article.author == "@newswire" || article.author == "@marketwired") ? 'wire' : '' %>">
    <div class="article-inner">
        <% if(article.deleted_at) { %>
            This article has been deleted.
        <% } else { %>

            <%
                var raw_date = article.published_at ? article.published_at : article.created_at;
                var date = common.format_date(raw_date);
            %>

            <div class="author">
                by <a data-channel="<%- article.author %>" class="hash at" href="/<%- article.author %>"><%- article.author %></a> on <%= date %> 
                <% if (admin || article.author == handle) { %>
                    <a class="article-edit-button edit" data-handle='<%- article.author %>' data-slug='<%- article.slug %>'><span class="icon-pencil"></span> edit</a>
                <% } %>
            </div>
            <div class='title'><%= article.title %></div>
            <div class='actions'>

                <% if(article.author == "@newswire") { %>
                    <a href="http://www.newswire.ca/" target="_blank" title="From CNW Newswire"><img src="/public/assets/logos/newswire.png" style="height: 20px; border: none; margin-right: 10px;" /></a>
                <% } %>
                <% if(article.author == "@marketwired") { %>
                    <a href="http://www.marketwired.com/" target="_blank" title="From Marketwired"><img src="/public/assets/logos/marketwired.png" style="height: 20px; border: none; margin-right: 10px;" /></a>
                <% } %>
                <span style="font-size: 18px;">
                    <%- (typeof t !== 'undefined') ? t.render('partials/article_share_buttons.html', { article: article }) : Template("article_share_buttons_tmpl", { article: article }) %>
                </span>
                <% if(admin) { %>
                    <span class="toggle-featured <%= (article.tags && article.tags.indexOf('featured') != -1) ? 'featured' : '' %>" title='Featured toggle' data-id="<%= article.id %>">
                        <span class="icon-star-full" /></span>
                    </span>
                    <span class="toggle-pinned <%= (article.pinned && article.pinned == '1') ? 'pinned' : '' %>" data-id="<%= article.id %>">
                        <span class="icon-pin"></span>
                    </span>
                <% } %>

            </div>
            <div class="article-body article">
                <%- article.body %>
            </div>

            <div class="article-share-icons share-icons" style="text-align:center;font-size:22px;">
                <%- (typeof t !== 'undefined') ? t.render('partials/article_share_buttons.html', { article: article }) : Template("article_share_buttons_tmpl", { article: article }) %>
            </div>

            <div style="clear:both;"></div>

        <% } %>
    </div>
</div>

            </script>
        
            <script type="text/html" id="my_articles_tmpl" class="template">
                <div>
    <% if (author == null) { %>
        You must <a class="claim-username">claim your username</a> first.
    <% } else { %>
        <% if(loading) { %>
            loading...
        <% } else { %>
            <% if (!articles || articles.length == 0) { %>
                You haven't created any articles yet.<br><br>
            <% } %>
            <div class='open-article new' data-slug="">
                + Create new article
            </div>
             <% if (articles && articles.length > 0) { %>
                <% articles.forEach(function(article) { %>
                    <div class='open-article' data-slug="<%= article.slug %>">
                        <%= article.title %>
                    </div>
                <% }); %>
            <% } %>

        <% } %>
    <% } %>
</div>


            </script>
        
            <script type="text/html" id="edit_profile_tmpl" class="template">
                <div id="edit-profile-modal" class="cover">
    <div class="modal generic big-buttons">
        <div class="outer">

            <% if(user && user.handle) { %>
                <div class="header">
                    Your public profile
                </div>

                <div class="inner scroll">
                    <p style="font-size: 1.2em;">Success! You now own <a href="/<%= user.handle %>"><%= user.handle %></a>.</p>
                    <p>Here are some features you can use:</p>
                    <ul class="success">
                        <li>Only you are allowed to use the name <strong><%= user.handle %></strong></li>
                        <li><a href="/<%= user.handle %>">Make a public profile</a> to network easily</li>
                        <li>Get notified when your name is mentioned</li>
                        <li>Write articles</li>
                    </ul>
                </div>
            <% } else { %>
                <div class="header">
                    Claim your name
                </div>

                <div class="inner scroll">
                    <p>What handle would you like to reserve for yourself?</p>
                    <form id="claim-name-form">
                        <div class='input'>@<input type="text" placeholder="Enter a handle" name="handle" value="<%= new_handle %>" /></div><button type="submit" <%= loading ? '"disabled"' : '' %>>Claim</button>
                    </form>

                    <% if(loading) { %>
                        <div>
                            Checking name availability...
                        </div>
                    <% } %>
                    <% if(error) { %>
                        <div class="error">
                            <%- error %>
                        </div>
                    <% } %>
                </div>
            <% } %>

            <div class="close">&times;</div>
        </div>
    </div>
</div>


            </script>
        
            <script type="text/html" id="profile_tmpl" class="template">
                <% if(typeof editing == "undefined") var editing = false; %>
<div class="padding <%= (collapsed && !editing) ? 'collapsed' : 'expanded' %>">

    <span class='joined'>
        <% if(profile.bot) { %>
            Bot
        <% } else { %>
            Joined <%= profile.joined ? common.format_date(profile.joined) : "early 2015" %>
        <% } %>
    </span>
    <div class="pic">
        <% if(profile.thumbnail_url) { %>
            <img src="<%= profile.thumbnail_url %>" />
        <% } else { %>
            <img src="/public/assets/profile.png" />
        <% } %>
        <% if(editing) { %>
            <div class='label upload-picture'>Upload</div>
            <input type="file" class="upload" style="display: none;" value="upload">
        <% } %>
    </div>
    <div class='details'>
        <% if(editing) { %>
            <input type="text" name="fullname" value="<%= profile.fullname %>" placeholder="Your full name" />
        <% } else if(profile.fullname) { %>
            <h1><%= profile.fullname %></h1>
        <% } %>
        <% if(editing) { %>
            <textarea name="description" placeholder="Your profile description & public information"><%= profile.description %></textarea>
        <% } else { %>
            <div class="description">
                <% if(profile.description) { %>
                    <%
                        var desc;
                        var truncated;
                        if(profile.description.length > 100) {
                            truncated = true;
                            desc = profile.description.slice(0, 95);
                        } else if(profile.description.split(/\r\n|\r|\n/).length > 3) {
                            desc = profile.description.split("\n").slice(0, 2).join("\n");
                            truncated = true;
                        } else {
                            desc = profile.description;
                            truncated = false;
                        }

                        if(!collapsed) {
                            desc = profile.description;
                        }
                    %>
                    <%- common.linkify('', common.htmlentities(desc)).replace(/(?:\r\n|\r|\n)/g, '<br />') %>
                <% } %>
            </div>
        <% } %>
        
        <% if(profile.editable) { %>
            <% if(typeof editing != "undefined" && editing) { %>
                <span class="action save-profile">Save profile</span>
            <% } else { %>
                <span class="action edit-profile"><span class='icon icon-pencil'></span> Edit profile</span>
            <% } %>
        <% } else if(profile.own_profile && !profile.editable) { %>
            Your account must get verified before you can edit your profile.
        <% } else if(!profile.own_profile && context.logged_in) { %>
            <span class="action invite-user"><span class='icon icon-bubble'></span> Private message</span>
            <% if (context.role == "admin") { %>
                <span class="action get-user-info" data-handle="<%= profile.handle %>">? User Info</span><br />
            <% } else { %>
                <br />
            <% } %>
            <% if(profile.ignored) { %>
                <span class="action unignore-user" data-handle="<%= profile.handle %>"><span class='icon icon-mute'></span> Ignored - Cancel</span>
            <% } else { %>
                <span class="action ignore-user" data-handle="<%= profile.handle %>"><span class='icon icon-mute'></span> Ignore</span>
            <% } %>
            <% if(profile.blocked) { %>
                <span class="action unblock-user" data-handle="<%= profile.handle %>"><span class='icon icon-cross'></span> Blocked - Cancel</span>
            <% } else { %>
                <span class="action block-user" data-handle="<%= profile.handle %>"><span class='icon icon-cross'></span> Block</span>
            <% } %>
        <% } %>
        <% if (!profile.editable && (context.role == "admin" || context.role == "site_moderator")) { %>
            <span class="action mute" handle="<%= profile.handle %>"><span class='icon-auction icon'></span>Ban user</span>
        <% } %>
    </div>
    <% if(profile.shared_watchlists) { %>
        <div class='watchlist'>
            <div class='channels-list detailed'>
                <% 
                    var state = {
                        current_channel: '',
                        collapsed: {},
                        channel_categories: [{id: 'Shared Watchlists', channels: profile.shared_watchlists}],
                    };
                %>
                <%- (typeof t !== 'undefined') ? t.render('partials/watchlist.html', state) : Template("watchlist_tmpl", state) %>
            </div>
        </div>
    <% } %>
</div>
<div class="separator"></div>

            </script>
        
            <script type="text/html" id="article_share_buttons_tmpl" class="template">
                <a class='share-button' href="http://www.facebook.com/sharer.php?u=https://ceo.ca/<%=article.author%>/<%=article.slug%>" target = "_blank"><span class='icon icon-facebook2'></span></a>
<a class='share-button' href="http://twitter.com/share?url=https://ceo.ca/<%=article.author%>/<%=article.slug%>&hashtags=&text=<%= article.title %>%20by%20<%= article.author %>" target="_blank"><span class='icon icon-twitter2'></span></a>
<a class='share-button' href="http://www.linkedin.com/shareArticle?mini=true&url=https://ceo.ca/<%=article.author%>/<%=article.slug%>&summary=<%= article.title %>%20by%20<%= article.author %>&title=CEO.ca <%= article.title %>" target = "_blank"><span class='icon icon-linkedin'></span></a>
<a class='share-button' target="_blank" href="mailto:?Subject=An article from CEO.ca&Body=<%=encodeURIComponent(article.title)%>%20by%20<%= encodeURIComponent(article.author) %>%0A%0Ahttps://ceo.ca/<%=article.author%>/<%=article.slug%>" target="_blank"><span class='icon icon-mail'></span></a>
<a class='share-button url' target="_blank" href="https://ceo.ca/<%=article.author%>/<%=article.slug%>"><span class='icon icon-link'></span></a>

            </script>
        
            <script type="text/html" id="discover_inner_tmpl" class="template">
                <div class="padding">
    <%
        context.categories = [
            {key: "featured", title: "featured articles",},
            {key: "community", title: "community articles",},
        ];
    %>
    <%- (typeof t !== 'undefined') ? t.render('partials/articles.html', context) : Template("articles_tmpl", context) %>

    <div class='spacer big'></div>

    <div class="links">
        <h3>links</h3>
        <div class='link videos'>
            <a class="" href="https://www.youtube.com/user/ceocafilm/videos" target="_blank"><span class='icon icon-youtube'></span> Videos</a>
        </div>
        <div class='link'>
            <a class="go-to" data-channel="@tommy/about" href="/@tommy/about"><span class='icon' style="font-size: 20px;">▲</span> About</a>
        </div>
        <div class='link'>
            <a class="go-to" data-channel="@tommy/ceoca-house-rules" href="/@tommy/ceoca-house-rules"><span class='icon icon-home'></span> House Rules</a>
        </div>
    </div>

    <div class="mobile">
        <h3>downloads</h3>
        <div class="downloads">
            <a href="https://itunes.apple.com/us/app/ceo.ca/id994342021"><img class="appstore" src="/public/assets/appstore.svg" /></a>
            <a href="https://play.google.com/store/apps/details?id=ca.ceo.chat.ceoca&hl=en"><img class="googleplay" src="/public/assets/googleplay.svg" /></a>
        </div>
    </div>

    <div class="legal">
        <h3>legal</h3>
        <div class="text" style="margin-top: 5px;">
            Use of this site indicates acceptance of the
            <a href="/@tommy/privacy-policy" class="hash go-to" data-channel="@tommy/privacy-policy">Privacy Policy</a>
            and
            <a href="/@tommy/terms-of-use" class="hash go-to" data-channel="@tommy/terms-of-use">Terms of Use</a>.
        </div>
        <div class="text">
            <div style="margin-top: 10px;">
                The information on this Website is not reliable and not intended to provide tax, legal, or investment advice. Nothing contained on the Website shall be considered a recommendation, solicitation, or offer to buy or sell a security to any person in any jurisdiction.    
            </div>

            <div style="margin-top: 10px;">CEO.CA members discuss high-risk penny stocks which can lose their entire value. Only risk what you can afford to lose. </div>

            <div style="margin-top: 10px;">© 2016 - Pacific Website Company Inc.</div>
        </div>
    </div>
</div>

            </script>
        
            <script type="text/html" id="discover_tmpl" class="template">
                
<div class="inner">
    <%- (typeof t !== 'undefined') ? t.render('partials/discover_inner.html', data) : Template("discover_inner_tmpl", data) %>
</div>

            </script>
        
            <script type="text/html" id="left_sidebar_title_tmpl" class="template">
                
<div class="see-all">
    <% if(context.loading) { %>
        <div class="fullname">
            Loading...
        </div>
    <% } else { %>
        <% if (context.shared_watchlist) { %>
            <div class="fullname company">
                <%= shared_watchlist.name %>
            </div>
        <% } else if (stock_info) { %>
            <div class="fullname company">
                <%= stock_info.company ? stock_info.company : '' %>
                <span class="symbol">
                    <%= stock_info.symbol ? stock_info.symbol : '' %>
                </span>
            </div>
        <% } else if(common.is_article(current_channel) || current_channel == "") { %>
            <div class="fullname">
                Articles
            </div>
        <% } else { %>
            <div class="fullname">
                <%
                    common.format_channel(current_channel)

                    var item = {
                        type: stock_info && stock_info.symbol ? "cash" : "",
                        channel: current_channel,
                    }

                    var formatting = common.get_channel_formatting(item);
                %>
                <%- formatting.icon ? formatting.icon : '' %><%= formatting.label %>
            </div>
        <% } %>
    <% } %>
</div>

            </script>
        
            <script type="text/html" id="start_channel_tmpl" class="template">
                <% if (status) { %>
	<%- status %><br><br>
<% } %>
    <div class='big-buttons'>
        <label class="<%= type == "Public" ? 'selected' : '' %>">
            <input type="radio" name="type" value="Public" <%= type == "Public" ? 'checked' : '' %> /> #public
        </label>
        <label class="<%= type == "Panel" ? 'selected' : '' %>">
            <input type="radio" name="type" value="Panel" <%= type == "Panel" ? 'checked' : '' %> /> <span class='icon icon-mic'></span> ~panel
        </label>
        <label class="<%= type == "Private" ? 'selected' : '' %>">
            <input type="radio" name="type" value="Private" <%= type == "Private" ? 'checked' : '' %> /> <span class='icon icon-lock'></span>.private
        </label>
        <div class="description">
            <p>
                <% if(type == "Public") { %>
                    Public channels are visible &amp; open to all members.
                <% } else if(type == "Private") { %>
                    Private channels are only visible to invited members.
                <% } else { %>
                    Panels are visible to all users, however only invited members are allowed to post.
                <% } %>
                <br />
                Name your new channel below.
            </p>
            <form autocomplete="off">

                <div>
                <span class='inline-edit-wrapper typing-new-channel'><span class='prefix'><%- type == "Private" ? "<span class='icon icon-lock'></span>." : type == "Panel" ? "<span class='icon icon-mic'></span>~" : "#" %></span><input class='edit' name="channel" type="text" placeholder="name-a-channel" /></span>
                </div>
                <button type="submit">Go</button>
            </form>
        </div>
    </div>

            </script>
        
            <script type="text/html" id="autocomplete_tmpl" class="template">
                <table class="<%= namespace %> autocomplete-results symbol_search_results">
    <% for (var i=0; i < (data ? data.length : 0); i++) { %>
        <%
            var display_row = data[i].display;
            var submit_row = data[i].submit;
            var type = data[i].type;
            if (typeof display_row != 'object') { display_row = [display_row] }
        %>
        <tr>
	        <% display_row.forEach(function(column){ %>
			        <td>
                        <span class='value' style="display:block" data-type="<%= type %>" data-submit-value="<%= submit_row %>">
                            <%= column %>
                        </span>
                    </td>
	        <% }) %>
	    </tr>
    <% } %>
</table>

            </script>
        
            <script type="text/html" id="mod_tools_ban_tmpl" class="template">
                <div class='big-buttons'>
    <%= handle %><% if (role == "admin") { %>/<%= email %><% } %><br><br>

    <% if (!giving_penalty && !making_silent) { %>

        <button data-banned='<%- banned_from_channel %>'><% if (!banned_from_channel){%> Ban from <%- channel %><% } else { %>Unban from <%- channel %><% } %></button><br>
        <% if (role == "admin" || role == "site_moderator") { %>
            <button data-silenced='<%- silenced %>'>
                <% if (!silenced){%>Silence<% } else { %>Unsilence <%- silenced_time_left > 0 ? '('+silenced_time_left+'min left)' : null %><% } %>
            </button>
            <br>
            <button data-penalized='<%- penalized %>'>
                <% if (!penalized){%>Put in penalty box<% } else { %>End penalty <%- penalized_time_left > 0 ? '('+penalized_time_left+'min left)' : null %><% } %>
            </button>
            <br>
            <button data-totally-banned='<%- totally_banned %>'><% if (!totally_banned){%> Ban from CEO.ca<% } else { %>Unban from CEO.ca<% } %></button><br>
            <button data-article-ban='<%- banned_from_articles %>'><% if (!banned_from_articles){%> Ban from ARTICLES<% } else { %>Unban from ARTICLES<% } %></button><br>
        <% } %>

     <% } else if (giving_penalty || making_silent) { %>
        <form class='<%- giving_penalty ? "penalized-form" : "silenced-form" %>'>
            <% if (giving_penalty) { %>
                <span>How long in minutes? (0 is forever, a day is 1440)<br><br>Channel will default to #penalty-box if none is given.</span>
            <% } else { %>
                <span>How long in minutes? (0 is forever, a day is 1440)</span>
            <% } %><br><br>


            <input required type="text" name="minutes" placeholder="minutes" /><br><br>
            <% if (giving_penalty) { %>
                <input type="text" name="channel" placeholder="channel" /><br><br>
            <% } %>
            <button type="submit"><%- giving_penalty ? 'penalize' : 'silence' %></button>
        </form>
        <span class='back-button' style="position:absolute;top:8px;left:10px;color:white;cursor:pointer;">◀</span>
     <% } %>
</div>

            </script>
        
            <script type="text/html" id="market_depth_tables_tmpl" class="template">
                <% 
    if(context.orders) {
        var bids = {};
        var asks = {};

        var bids_arr = [];
        var asks_arr = [];

        var price_bids = {};
        var price_asks = {};
        var price_bids_arr = [];
        var price_asks_arr = [];

        for(var id in orders) {
            var order = orders[id];
            var key = order.house + order.price;
            var price = order.price;
            if(order.bid_ask == 'bid') {
                if(bids[key] == undefined) {
                    bids[key] = order;
                    bids[key].total = 0;
                }
                if(price_bids[price] == undefined) {
                    price_bids[price] = {
                        total: 0,
                        value: 0,
                        price: price,
                        bid_ask: 'bid',
                    }
                }
                bids[key].total += parseInt(order.volume);
                price_bids[price].total += parseInt(order.volume);
                price_bids[price].value += parseInt(order.volume * price);
            }
            if(order.bid_ask == 'ask') {
                if(asks[key] == undefined) {
                    asks[key] = order;
                    asks[key].total = 0;
                }
                if(price_asks[price] == undefined) {
                    price_asks[price] = {
                        total: 0,
                        value: 0,
                        price: price,
                        bid_ask: 'ask',
                    }
                }
                asks[key].total += parseInt(order.volume);
                if(asks[key].timestamp < order.timestamp) {
                    asks[key].timestamp = order.timestamp;
                }
                price_asks[price].total += parseInt(order.volume);
                price_asks[price].value += parseInt(order.volume * price);
            }
        }
        for(key in bids) {
            if(key) {
                bids_arr.push(bids[key]);
            }
        }
        for(key in asks) {
            if(key) {
                asks_arr.push(asks[key]);
            }
        }

        bids_arr.sort(function(a, b){
            if(a.price == b.price) {
                return (parseFloat(a.timestamp) - parseFloat(b.timestamp));
            } else {
                return (parseFloat(b.price) - parseFloat(a.price));
            }
        });
        asks_arr.sort(function(a, b){
            if(a.price == b.price) {
                return (parseFloat(b.timestamp) - parseFloat(a.timestamp));
            } else {
                return (parseFloat(a.price) - parseFloat(b.price));
            }
        });
        bids_arr = bids_arr.splice(0, 10);
        asks_arr = asks_arr.splice(0, 10);

        var orders_sorted = bids_arr.concat(asks_arr);
        orders_sorted = orders_sorted.sort(function(a, b){
            if(a.bid_ask == 'ask' && b.bid_ask == 'bid') {
                return -1;
            } else if(a.bid_ask == 'bid' && b.bid_ask == 'ask') {
                return 1;
            }
            return (parseFloat(b.price) - parseFloat(a.price));
        });



        for(key in price_bids) {
            if(key) {
                price_bids_arr.push(price_bids[key]);
            }
        }
        for(key in price_asks) {
            if(key) {
                price_asks_arr.push(price_asks[key]);
            }
        }
        price_bids_arr.sort(function(a, b){
            return (parseFloat(b.price) - parseFloat(a.price));
        });
        price_asks_arr.sort(function(a, b){
            return (parseFloat(a.price) - parseFloat(b.price));
        });
        price_bids_arr = price_bids_arr.splice(0, 2);
        price_asks_arr = price_asks_arr.splice(0, 2);

        var price_orders_sorted = price_bids_arr.concat(price_asks_arr).sort(function(a, b){
            if(a.bid_ask == 'ask' && b.bid_ask == 'bid') {
                return -1;
            } else if(a.bid_ask == 'bid' && b.bid_ask == 'ask') {
                return 1;
            }
            return (parseFloat(b.price) - parseFloat(a.price));
        });
        price_orders_sorted = price_orders_sorted.sort(function(a, b){
            return (parseFloat(b.price) - parseFloat(a.price));
        });
    }
%>

<div class="note <%= (common.symbol_has_lvl2(symbol)) ? 'hidden' : ''%>">
    Market depth is only available on TSX &amp; TSXV stocks
</div>
<div class='widget'>
    <h3 style='margin-bottom: 5px;'>Reports</h3>
    <a href='#' class='report' id="open-house-positions" data-symbol="<%- symbol %>"><span class='icon house-pos icon-file-text'></span> House Positions</a>

    <h3>Market by price</h3>
    <table>
        <% if(context.orders) { %>
            <tr>
                <th key="price">Price</th>
                <th key="total">Total volume</th>
                <th key="value">Value</th>
            </tr>
            <% price_orders_sorted.forEach(function(order) { %>
                <tr class="<%= order.bid_ask %>">
                    <% ['price', 'total', 'value'].forEach(function(key) { %>
                        <% var val = order[key]; %>
                        <% if(key == 'price') { val = common.format_price(val); } %>
                        <% if(key == 'total') { val = common.format_price(val, 0); } %>
                        <% if(key == 'value') { val = "$" + common.format_price(val, 0); } %>
                        <td><%= val %></td>
                    <% }); %>
                </tr>
            <% }); %>
        <% } else { %>
            <tr><td colspan='2'>None</td</tr>
        <% } %>
    </table>
    <h3>Market by order</h3>
    <table>
        <% if(context.orders) { %>
            <tr>
                <% ['price', 'total', 'house', 'timestamp'].forEach(function(key) { %>
                    <% if(key == "timestamp") key = "Time"; %>
                    <% if(key == "total") key = "Volume"; %>
                    <th key="<%= key %>"><%= key %> <% if(key == 'price') { %><span class='icon icon-chevron-down'></span><% } %></th>
                <% }); %>
            </tr>
            <% orders_sorted.forEach(function(order) { %>
                <tr class="<%= order.bid_ask %>">
                    <% ['price', 'total', 'house', 'timestamp'].forEach(function(key) { %>
                        <% var val = order[key]; %>
                        <% if(key == 'price') { val = common.format_price(val); } %>
                        <% if(key == 'total') { val = common.format_price(val, 0); } %>
                        <%
                            if(key == 'timestamp') {
                                var today = new Date(Date.now());
                                var date = new Date(val);
                                var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
                                if(today.getMonth() != date.getMonth() || today.getDate() != date.getDate()) {
                                    val = monthNames[date.getMonth()] + " " + date.getDate();
                                } else {
                                    val = common.format_time(val);
                                }
                            }
                        %>
                        <td><%= val %></td>
                    <% }); %>
                </tr>
            <% }); %>
        <% } else { %>
            <tr><td colspan='4'>None</td</tr>
        <% } %>
    </table>
</div>

<div class='widget recent-trades'>
    <h3>
        Recent trades
        <span class='arrows'>
            <span class="icon icon-chevron-left recent_trades_table_newer <%= (context.recent_trades_current_page == 0) ? 'disabled' : '' %>"></span>
            <span class="icon back_to_most_recent <%= (context.recent_trades_current_page == 0) ? 'disabled' : '' %>">●</span>
            <span class="icon icon-chevron-right recent_trades_table_older <%= (context.recent_trades_last_page) ? 'disabled' : '' %>"></span>
        </span>
    </h3>
    <table>
        <% var table_rows = context.recent_trades_ROWS || 27; %>
        <% if(context.trades) { %>
            <% 
                var rt_current_page = context.recent_trades_current_page;
                var trades_length = context.trades.length;
                
                // if the number of trades was divided evenly by the number of rows
                // there will not be a 'partial' last page (where number of rows is less than recent_trades_ROWS)
                // -> in this case, don't render the table again - the page will be empty
                var evenly_divided = (trades_length / table_rows - rt_current_page) === 0;
                var effective_page = evenly_divided ? rt_current_page - 1 : rt_current_page;
                    
                var cols = ['Seller', 'Buyer', 'Price', 'Volume', 'Total', 'Time'];
                var keys = ['house', 'buyer', 'price', 'volume', 'total', 'timestamp'];

                // filter out ticks
                var _trades = context.trades
                    .filter(function(t){ return t.house })
                    .sort(function(a, b){
                        return (parseFloat(b.timestamp) - parseFloat(a.timestamp));
                    })

                // this will be true in the cached case
                var min_range = table_rows * effective_page;
                
                _trades = _trades.splice(min_range, table_rows);
            %>
            <tr>
                <% cols.forEach(function(col, i) { %>
                    <th key="<%= col %>"><%= cols[i] %></th>
                <% }); %>
            </tr>
            <% var max_vol = 0; %>
            <% _trades.forEach(function(trade) {
                if(parseInt(trade.volume) > max_vol) max_vol = parseInt(trade.volume);
            }); %>
            <% _trades.forEach(function(trade) { %>
                <tr class="trade" style="background: rgba(180, 200, 255, <%= 0.1 + 0.4 * parseInt(trade.volume) / max_vol %>);">
                    <% keys.forEach(function(key) { %>
                        <% var val = trade[key]; %>
                        <% if(key == 'price') { val = common.format_price(val); } %>
                        <% if(key == 'timestamp') {
                            var today = new Date(Date.now());
                            var date = new Date(val);
                            var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
                            if(today.getMonth() != date.getMonth() || today.getDate() != date.getDate()) {
                                val = monthNames[date.getMonth()] + " " + date.getDate();
                            } else {
                                val = common.format_time(val);
                            }
                        } %>
                        <% if(key == 'total') { val = "$" + common.format_price(trade.price * trade.volume, 0); } %>
                        <% if(key == 'volume') { val = common.format_price(val, 0); } %>
                        <td>
                            <%= val %>
                        </td>
                    <% }); %>
                </tr>
            <% }); %>
        <% } else { %>
            <tr><td colspan='4'>None</td</tr>
        <% } %>
    </table>
</div>

            </script>
        
            <script type="text/html" id="newsedi_tmpl" class="template">
                <div id="newsedi-container">
    <div id="newsedi-content">
        <%- (typeof t !== 'undefined') ? t.render('partials/newsedi_content.html', context) : Template("newsedi_content_tmpl", {state:context}) %>
    </div>
    <div id="newsedi-detail"></div>
</div>

            </script>
        
            <script type="text/html" id="newsedi_content_tmpl" class="template">
                <% if (state.tab == 'filings') { %>
    <div id="newsedi-filter">
        <div class="filter-box" id="newsedi-filter-insider">
            <div class="label">Filter by Insider</div>
            <div class="newsedi-filter-query-container">
                <input id="newsedi-filter-insider-query" data-filtertype="insider" class="newsedi-filter-query" type='text' placeholder='Insider Name' value='<%= state.filters.insider %>' />
                <span class="newsedi-filter-query-x" data-filtertype="insider">&times;</span>
            </div>
            <div id="newsedi-filter-insider-suggestions" class='newsedi-filter-suggestions'></div>
        </div>
        <div class="filter-box" id="newsedi-filter-company">
            <div class="label">Filter by Company</div>
            <div class="newsedi-filter-query-container">
                <input id="newsedi-filter-company-query" data-filtertype="company" class="newsedi-filter-query" type='text' placeholder='Company Name' value='<%= state.filters.company_symbol %>' />
                <span class="newsedi-filter-query-x" data-filtertype="company">&times;</span>
            </div>
            <div id="newsedi-filter-company-suggestions" class='newsedi-filter-suggestions'></div>
        </div>
    </div>
    <div id="newsedi-inner">
        <%- (typeof t !== 'undefined') ? t.render('partials/newsedi_results.html', {state:state}) : Template("newsedi_results_tmpl", {state:state}) %>
    </div>
<% } else { %>
    <div id="newsedi-insiders">
        <% if (state.user_logged_in) { %> 
            <% if (state.loading) { %>
                <span class="loading">Loading</span>
            <% } else { %>
                <% for (var i = 0, x = state.insiders.length; i < x; i++) { %>
                    <div class="newsedi-insider-item">
                        <span class="newsedi-insider-name"><%=state.insiders[i].insider_name %></span>
                        <span data-name="<%= state.insiders[i].insider_name %>" class="newsedi-unsubscribe"></span>
                    </div>
                <% } %>
            <% } %>
        <% } else { %>
            Sign up to CEO.CA Pro Accounts and get Insider activity in your email.
        <% } %>
    </div>
<% } %>

            </script>
        
            <script type="text/html" id="newsedi_results_tmpl" class="template">
                <% if (state.filters.insider && user_logged_in) { %>
    <% if (state.loading) { %>
    <% } else { %>
    <!-- 
        <div id="newsedi-insider-subscribe">
            <span class="label">Get email updates for <%= state.filters.insider %></span><span class="newsedi-<%= (state.insider_subscribed ? 'un' : '') %>subscribe" data-name="<%= state.filters.insider %>"></span>
        </div>
    -->
    <% } %>
<% } %>
<div id="newsedi-results-container">
    <div id="newsedi-results-table-container">
        <table id="newsedi-results">
            <% if (state.loading) { %>
                <tr class="filing-row">
                    <td class="cell">Loading...</td>
                </tr>
            <% } else if(state.results.length > 0) { %>
                <tr>
                    <th></th>
                    <% for (var i = 0, header = ['Date','Closing date', 'Issuer','Insider','Transaction','Type','Volume','Price', 'Total']; i < header.length; i++) { %>
                        <th col="<%= i %>" class="<%= (i == state.sort_column ? state.filters.column_dir : '') %>"><%= header[i] %></th>
                    <% } %>
                </tr>
                <% for (var i = 0; i < state.results.length; i++) { %>
                    <tr class="filing-row">
                        <td><span id="filing-<%=i %>" class="newsedi-show-detail"><span class='icon icon-plus'></span></span></td>
                        <td><%= state.results[i]['datab']['Date of transaction'] %></td>
                        <td><%= state.results[i]['datab']['Closing date'] %></td>
                        <td>
                            <strong>$<%= state.results[i]['datab']['Stock Symbol'] %></strong>
                            <br /><%= state.results[i]['datab']['Issuer Name'] %>
                        </td>
                        <td>
                            <strong><%= state.results[i]['datab']['Insider Name'] %></strong>
                            <div class='relationship'>
                                <%= state.results[i]['datab']["Insider's Relationship to Issuer"] %>
                            </div>
                        </td>
                        <td class='desc'><%= state.results[i]['datab']['Nature of transaction'] %></td>
                        <td><%= state.results[i]['datab']['Security designation'] %></td>
                        <td>
                            <% var volume = state.results[i]['datab']['Number or value acquired or disposed of'] %>
                            <%- volume[0] == "+" ? "<span class='bought'>" : "" %>
                            <%- volume[0] == "-" ? "<span class='sold'>" : "" %>
                            <%= volume %>
                            <%- volume[0] == "+" ? "</span>" : "" %>
                            <%- volume[0] == "-" ? "</span>" : "" %>
                        </td>
                        <td><%= state.results[i]['datab']['Unit price or exercise price'] %></td>
                        <td><%= state.results[i]['datab']['Balance of securities held as of transaction date'] %></td>
                    </tr>
                <% } %>
            <% } else { %>
                <tr class="filing-row">
                    <td class="cell">No results.</td>
                </tr>
            <% } %>
        </table>
    </div>
</div>

            </script>
        
            <script type="text/html" id="newsedi_filing_tmpl" class="template">
                <div id="newsedi-filing">
    <% for (var i = 0; i < Object.keys(state.detail.datab).length; i++){ %>
        <div class="newsedi-filing-row">
            <span class="newsedi-filing-key"><%= Object.keys(state.detail.datab)[i] %></span><br>
            <span class="newsedi-filing-value"><%= state.detail.datab[Object.keys(state.detail.datab)[i]] %></span>
        </div>
    <% } %>
</div>
            </script>
        
            <script type="text/html" id="watchlist_settings_tmpl" class="template">
                
<% if(loading) { %>
    Loading...
<% } else { %>
    <div class='info'>
        <p>You can turn sidebar notifications off for a given watchlist cateogry if the new message notifications get too noisy.
    </div>
    <div class='section'>
        Sidebar notifications
        <label class="<%= sidebar_notifications == "on" ? 'selected' : '' %>">
            <input type="radio" name="sidebar_notifications" value="on" <%= sidebar_notifications == "on" ? 'checked' : '' %> /> On
        </label>
        <label class="<%= sidebar_notifications == "off" ? 'selected' : '' %>">
            <input type="radio" name="sidebar_notifications" value="off" <%= sidebar_notifications == "off" ? 'checked' : '' %> /> Off
        </label>
        <% if(context.sidebar_notifications_saved) { %><span id='sidebar-notifications-saved' style='font-size: 12px; color: #4a4;'>&nbsp; saved</span><% } %>
    </div>
    <hr />
    <div class='info'>
        <p>You can enable the <strong>watchlist category "<%= category.name %>"</strong> for sharing.</p>
        <p>After turning sharing on, the watchlist will get its own <strong>chat channel</strong>, with the companies listed on the same page.</p>
    </div>
    <div class='section privacy'>
        <label class="<%= selection == "off" ? 'selected' : '' %>">
            <input type="radio" name="selection" value="off" <%= selection == "off" ? 'checked' : '' %> /> Off
        </label>
        <label class="<%= selection == "public" ? 'selected' : '' %>">
            <input type="radio" name="selection" value="public" <%= selection == "public" ? 'checked' : '' %> /> Public
        </label>
        <label class="<%= selection == "private" ? 'selected' : '' %>">
            <input type="radio" name="selection" value="private" <%= selection == "private" ? 'checked' : '' %> /> Private
        </label>
        <label class="<%= selection == "paid" ? 'selected' : '' %>">
            <input type="radio" name="selection" value="paid" <%= selection == "paid" ? 'checked' : '' %> /> Paid
        </label>
        <div class="description">
            <form autocomplete="off">
                <p>
                    <% if(selection == "off") { %>
                        <% if(category.privacy == "off") { %>
                            <p>Watchlist sharing is OFF.</p>
                            <p>Only you can see the watchlist category "<%= category.name %>".</p>
                        <% } else {%>
                            <p>Watchlist sharing will be OFF.</p>
                            <p>Only you will see the watchlist category "<%= category.name %>".</p>

                            <button type="submit">Turn selection off</button>
                        <% } %>
                    <% } else if(selection == "private") { %>
                        <% if(category.privacy == "private") { %>
                            <p>Your watchlist category called "<%= category.name %>" is private.<br />Only invited users can see it.</p>
                        <% } else { %>
                            <p>Your watchlist category called "<%= category.name %>" will be private.<br />Only invited users will see it.</p>
                        <% } %>
                    <% } else if(selection == "public") { %>
                        <% if(category.privacy == "public") { %>
                            <p>Your watchlist category called "<%= category.name %>" is public.</p>
                        <% } else { %>
                            <p>Your are making your watchlist category called "<%= category.name %>" public.</p>
                        <% } %>
                    <% } else if(selection == "paid") { %>
                        <p>Paid watchlists are still under construction.</p>
                        <p>We are planning on letting our users charge their subscribers a custom fee.</p>
                        <p>Until then, you can gain a following with public watchlists.</p>
                    <% } %>
                </p>
                <% if(selection == "public") { %>
                    Name
                    <div class='input'>
                        <input name='name' type='text' class='editable' value='<%= category.name %>' />
                    </div>
                    <% if(category.created != 'yes') { %>
                        Public URL
                        <div class='input spiel-content'>
                            <% var channel = handle + ':' + category.slug %>
                            <% if(category.privacy == "public") { %>
                                <span class='prefix'><span class='domain'>https://ceo.ca/</span></span><%- common.linkify('', channel) %>
                            <% } else  { %>
                                <span class='prefix'><span class='domain'>https://ceo.ca/</span></span><%- handle + ':' %><input type='text' class='editable slug' value='<%= category.slug %>' />
                            <% } %>
                        </div>
                        Description
                        <div class='input editable'>
                            <textarea placeholder='Enter a public description of your watchlist'><%= category.description %></textarea>
                        </div>
                        <% if(category.privacy == "public") { %>
                            <input type='hidden' name='create' value='no' />
                            <button type="submit">Save</button>
                        <% } else  { %>
                            <input type='hidden' name='create' value='yes' />
                            <button type="submit">Make this category public</button>
                        <% } %>
                    <% } %>
                <% } else if(selection == "private") { %>
                    Name
                    <div class='input'>
                        <input name='name' type='text' class='editable' value='<%= category.name %>' />
                    </div>

                    <% if(category.created != 'yes') { %>
                        Private URL
                        <div class='input spiel-content'>
                            <% var channel = '.' + handle + ':' + category.slug %>
                            <% if(category.privacy == "private") { %>
                                <span class='prefix'><span class='domain'>https://ceo.ca/</span></span><a href='/<%= channel %>' class='slug go-to hash shared'><%= channel %></a>
                            <% } else  { %>
                                <span class='prefix'><span class='domain'>https://ceo.ca/</span></span><%- "." + handle + ':' %><input type='text' class='editable slug' value='<%= category.slug %>' />
                            <% } %>
                        </div>
                        Description
                        <div class='input editable'>
                            <textarea placeholder='Enter a description of your watchlist (optional)'><%= category.description %></textarea>
                        </div>
                        <% if(category.privacy == "private") { %>
                            <input type='hidden' name='create' value='no' />
                            <button type="submit">Save</button>
                        <% } else  { %>
                            <input type='hidden' name='create' value='yes' />
                            <button type="submit">Make this category private</button>
                        <% } %>
                    <% } %>
                <% } %>
                <% if(category.created == 'yes') { %>
                    <div class='input spiel-content'>
                        Your whatchlist channel has been created.<br />
                        <% var channel = (category.privacy == 'private' ? '.' : '') + handle + ':' + category.slug %>
                        <span class='prefix'><span class='domain'>https://ceo.ca/</span></span><a href='/<%= channel %>' data-channel="<%= channel %>" class='slug go-to hash shared'><%= channel %></a>
                    </div>
                    <button class="go-to hash shared" data-channel="<%= channel %>" style="background: #0a0;">Go to watchlist channel &raquo;</button>
                <% } %>
            </form>
        </div>
    </div>
<% } %>

            </script>
        
            <script type="text/html" id="watchlist_item_tmpl" class="template">
                <%
    var item = context.channel_item;
    var formatting = common.get_channel_formatting(item);

    var classes = formatting.classes;
    var label = formatting.label;
    var icon = formatting.icon;

    if(item.type == 'watchlist') {
        if(item.title) label = item.title;
        icon = '<span class="icon icon-th-list"></span> ';
    }

    if(item.channel.toLowerCase() === current_channel.toLowerCase()) {
        classes += " highlight";
    }
    if(context.logged_in && (common.is_private_channel(item.channel) || common.is_panel(item.channel)) && !item.last_seen) {
        classes += " alert";
    }

%><div class="channel <%= classes %> <%= (category_id == 'Commodities') ? 'commodity' : '' %>" channel="<%= item.channel %>">
    <a class="<%= context.edit ? '' : 'go-to' %>" data-channel="<%= item.channel %>" <% if(!context.edit) { %> href="/<%= item.channel %>" <% } %>>
        <% if(item.quote) { %>
            <div>
                <span class='channel-name cashtag'><%= label %></span>
                <% if(item.company || (item.title && context.show_titles)) { %>
                    <span class='desc'><%= item.company ? item.company : item.title %></span>
                <% } %>
            </div>
            <div class='quote'>
                <%
                    var arrow = "<span class='icon-arrow-" + (item.quote.direction == "down" ? "down" : "up")  + "'></span>";
                    // fix to AT LEAST two decimal places, possibly more
                    var value = item.quote.value;
                    value = parseFloat(value);
                    var orig_value = value;
                    value = common.auto_format_price(value);

                    var percent = parseFloat(item.quote.percent_change.replace("%", "").replace("+", "").replace("-", ""));
                    percent = percent ? percent.toFixed(1) : 0;

                    var price_change = parseFloat(item.quote.price_change);
                    price_change = common.auto_format_price(price_change);
                %>
                <span class='price'>
                    <%= value %>
                </span>
                <span class='<%= item.quote.direction %>'>
                    <%- arrow %><span class='price-change'><%= price_change %></span> <span class='percent'><%= percent+"%" %></span>
                </span>
                <% if(item.quote.bid && item.quote.ask) {%>
                    <div class='bid-ask'>
                        <div class='ask'>Ask <%= common.auto_format_price(item.quote.ask.price) %> <span class='vol'>&times;<%= item.quote.ask.volume %></span></div>
                        <div class='bid'>Bid <%= common.auto_format_price(item.quote.bid.price) %> <span class='vol'>&times;<%= item.quote.bid.volume %></span></div>
                        <div class='volume'><span>Vol</span> <%= common.number_formatter(parseInt(item.quote.volume), 2) %></div>
                    </div>
                <% } %>
            </div>
        <% } else { %>
            <span class='channel-name'><%- icon %><%= label %></span>
        <% } %>
        <div class="new-count" title="New message count - Click to clear">
            <% if(item.channel != current_channel && item.new_message_count > 0) { %>
                <% if(item.new_message_count >= 50) { %>
                    <%= Math.min(item.new_message_count, 50) + '+' %>
                <% } else { %>
                    <%= item.new_message_count %>
                <% } %>
            <% } %>
        </div>
    </a>
    <% if(context.logged_in && context.edit) { %>
        <div class="delete">&times;</div>
    <% } %>
</div>

            </script>
        
            <script type="text/html" id="pro_manager_tmpl" class="template">
                <iframe src="https://payments.ceo.ca"></iframe>

            </script>
        
            <script type="text/html" id="pro_banner_tmpl" class="template">
                <% if(context.symbol && symbol.length > 0) { %>
    <% 
        var has_lvl2 = common.symbol_has_lvl2(symbol);
        var allowed = (context.pro && context.allowed_exchanges.indexOf(common.exchange_code_for_symbol(symbol)) != -1 && has_lvl2);
    %>
    <% if(context.pro && !has_lvl2) { %>
    <% } else if(context.pro && !allowed && has_lvl2) { %>
        <h3>Market Depth</h3>
        <a class='get-pro upgrade'>
            <span class="icon"><img src="/public/assets/depth.png" /></span>
            <div class='text'>
                <div class='h1'>Upgrade your subscription</div>
                <div class='h2'>Real-time Level 2 Market Depth</div>
            </div>
        </a>
    <% } else if(!context.pro) { %>
        <h3>Market Depth</h3>
        <a class='get-pro new' href='/about/market-depth' target='_new'>
            <span class="icon"><img src="/public/assets/depth.png" /></span>
            <div class='text'>
                <div class='h1'>Get CEO.CA Pro</div>
                <div class='h2'>Real-time Level 2 Market Depth</div>
            </div>
        </a>
    <% } %>
<% } else if(!context.pro) { %>
        <a class='get-pro new' href='/about/market-depth' target='_new'>
            <span class="icon"><img src="/public/assets/depth.png" /></span>
            <div class='text'>
                <div class='h1'>Get CEO.CA Pro</div>
                <div class='h2'>Real-time Level 2 Market Depth</div>
            </div>
        </a>
<% } %>

            </script>
        
            <script type="text/html" id="datepicker_tmpl" class="template">
                <div class="datepicker inner">
    <p>Jump to date/time in <%= common.format_channel(current_channel) %></p>
    <form class='jump-to-date-form'>
        <select name='year'>
            <% for(var i=2014; i<=new Date().getFullYear(); i++) { %>
                <option <%= (new Date().getFullYear() == i) ? "selected" : "" %>><%= i %></option>
            <% } %>
        </select>
        <select name='month'>
            <% var monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']; %>
            <% for(var i=0; i<monthNames.length; i++) { %>
                <option value="<%= i+1 %>" <%= (new Date().getMonth() == i) ? "selected" : "" %>><%= monthNames[i] %></option>
            <% } %>
        </select>
        <select name='day'>
            <% for(var i=1; i<=31; i++) { %>
                <option <%= (new Date().getDate() == i) ? "selected" : "" %>><%= i %></option>
            <% } %>
        </select>
        <select name='hour'>
            <% for(var i=0; i<24; i++) { %>
                <option value='<%= i %>'><%= i == 12 ? 12 : i % 12 %>:00 <%= i > 11 ? "PM" : "AM" %></option>
            <% } %>
        </select>
        <br /><br />
        <input type='submit' value='Go' />
    </form>
</div>


            </script>
        
            <script type="text/html" id="shared_watchlist_tmpl" class="template">
                
<div class='watchlist'>
    <div class='channels-list detailed'>
        <div class='watchlist-description'>
            <div class='owner'><%- common.linkify('', shared_watchlist.handle) %>'s watchlist</div>
            <%- common.linkify('', common.htmlentities(shared_watchlist.description)).replace(/(?:\r\n|\r|\n)/g, '<br />') %>
        </div>
        <% 
            var state = {
                current_channel: context.current_channel,
                channel_categories: [shared_watchlist],
                show_titles: true,
           };
        %>
        <%- (typeof t !== 'undefined') ? t.render('partials/watchlist.html', state) : Template("watchlist_tmpl", state) %>
    </div>
</div>

            </script>
        
            <script type="text/html" id="house_positions_tmpl" class="template">
                <%
	function addCommas(nStr, appendStr) {
		if (!nStr) return 0;
	    nStr += '';
	    x = nStr.split('.');
	    x1 = x[0];
	    x2 = x.length > 1 ? '.' + x[1] : '';
	    var rgx = /(\d+)(\d{3})/;
	    while (rgx.test(x1)) {
	        x1 = x1.replace(rgx, '$1' + ',' + '$2');
	    }
	    return (appendStr || '') + x1 + x2;
	}
%>

<div id="house-positions">

    <% if(loading) { %>
        Loading...
    <% } else if (empty) { %>
        No <%= symbol %> shares have exchanged hands today.
    <% } else { %>
        <%- addCommas(totals.buy.volume) %> (<%= addCommas(totals.buy.value, '$') %>) <%= symbol %> shares exchanged hands today.
        <table class='parent'>
            <tr>
                <th>House</th>
                
                <th>Bought</th>
                <th>Sold</th>
                <th>Net</th>
            </tr>
            <% positions.forEach(function(position, index) {
                var house = position.house;
                var house_name = position.house_name;
                var position = position.position;
                var buy = position.buy;
                var sell = position.sell;
                var net = position.net;
                var zero_sell = sell.volume == undefined;
                var zero_buy = buy.volume == undefined;
            %>
                <tr>
                    <td>
                        <div class='code'>
                            House <%= house %>
                        </div>
                        <div class='housename'>
                            <%= house_name %>
                        </div>
                    </td>
                    <td>
                        <table class='child'>
                            <tr>
                                <th>Volume</th>
                                <td><%- addCommas(buy.volume) %></td>
                            </tr>
                            <tr>
                                <th>Total</th>
                                <td><%- addCommas(buy.total_value, '$') %></td>
                            <tr>
                            </tr>
                                <th>Average</th>
                                <td><%- addCommas(buy.avg_price && buy.avg_price.toFixed(3), '$') %></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                        <table class='child'>
                            <tr>
                                <th>Volume</th>
                                <td><%- addCommas(sell.volume) %></td>
                            </tr>
                            <tr>
                                <th>Total</th>
                                <td><%- addCommas(sell.total_value, '$') %></td>
                            <tr>
                            </tr>
                                <th>Average</th>
                                <td><%- addCommas(sell.avg_price && sell.avg_price.toFixed(3), '$') %></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                        <table class='child'>
                            <tr>
                                <th>Volume</th>
                                <td><%- addCommas(net.volume) %></td>
                            </tr>
                            <tr>
                                <th>Total</th>
                                <td><%- addCommas(net.value, '$') %></td>
                            <tr>
                        </table>
                    </td>
                </tr>
            <% }) %>

        </table>
    <% } %>
</div>

            </script>
        
            <script type="text/html" id="short_positions_tmpl" class="template">
                <%
	function addCommas(nStr, appendStr) {
		if (!nStr) return 0;
	    nStr += '';
	    x = nStr.split('.');
	    x1 = x[0];
	    x2 = x.length > 1 ? '.' + x[1] : '';
	    var rgx = /(\d+)(\d{3})/;
	    while (rgx.test(x1)) {
	        x1 = x1.replace(rgx, '$1' + ',' + '$2');
	    }
	    return (appendStr || '') + x1 + x2;
	}
%>

<div id="short-positions">

        <% if (!one_company) { %>
            <form id='short-positions-filter'>
                <label>
                    <div class='filter-box'>
                        filter by symbol:<br>
                        <div class="newsedi-filter-insider-query">
                            <input value="<%- symbol %>" name="symbol" placeholder="symbol" type="text" id='short-positions-symbol-filter' />
                            <span class="short-positions-clear-filter" style="margin-left: -20px;">×</span>
                        </div>
                    </div>
                </label>
                <label>
                    <div class='filter-box'>
                        filter by market:<br>
                        <select name="market" style="width:200px" id='short-positions-market-filter'>
                            <option value="all" <%- market == 'all' ? 'selected' : '' %> >All</option>
                            <option value="V" <%- market == 'V' ? 'selected' : '' %> >Venture</option>
                            <option value="TO" <%- market == 'TO' ? 'selected' : '' %> >TSX</option>
                        </select>
                    </div>
                </label>
                <input type="submit" value="Filter" />
            </form>
            <form id='short-positions-sort'>
                <label>
                    <div class='filter-box'>
                        sort by:<br>
                        <select name="sort_by" style="width:200px" id='short-positions-sort-select'>
                            <option value="symbol" <%- sort_by == 'symbol' ? 'selected' : '' %> >Symbol</option>
                            <option value="number_of_shares" <%- sort_by == 'number_of_shares' ? 'selected' : '' %> >Shares</option>
                            <option value="net_change" <%- sort_by == 'net_change' ? 'selected' : '' %> >Net Change</option>
                        </select>
                    </div>
                </label>
                <label>
                    <div class='filter-box'>
                        direction:<br>
                        <select name="sort_direction" style="width:200px" id='short-positions-sort-select'>
                            <option value="asc" <%- sort_direction == 'asc' ? 'selected' : '' %> >Ascending</option>
                            <option value="desc" <%- sort_direction == 'desc' ? 'selected' : '' %> >Descending</option>
                        </select>
                    </div>
                </label>
                <input type="submit" value="Sort" />
            </form>
            <br><br>
        <% } else { %>
            <span class='report' id="short-positions-open-all" style="cursor:pointer"><span class='icon house-pos icon-file-text'></span>  see all companies</span><br>
        <% } %>


        <% if (date) { %>
            <span> posted <%= date.split(',')[0] %> </span>
            <br><br>
        <% } %>


    <% if(loading) { %>
        <span class='loading'>Loading...</span>
    <% } else if (empty) { %>
        No data...
    <% } else { %>

        <table>
            <tr>
                <th>Symbol</th>
                <th>Issue Name</th>
                <th>Shares</th>
                <th>Net Change</th>
                <% if (one_company) { %>
                    <th>Date</th>
                <% } %>
            </tr>

            <% filtered_positions.slice(0,500).forEach(function(position, index) {
                var symbol = position.symbol;
                var issue_name = position.issue_name;
                var shares = position.number_of_shares;
                var net_change = position.net_change;

                var net_change_class = '';

                if ((net_change+'')[0] == '-') {
                    net_change_class = 'sold'
                } else if (net_change == '0') {

                } else {
                    net_change_class = 'bought'
                }
            %>
                <tr>
                    <td style="font-weight:bold">
                        <a href="<%- symbol.split('.')[0] %>" class="hash cash" data-channel="<%- symbol.split('.')[0] %>">$<%- symbol %></a>
                    </td>
                    <td>
                        <%- issue_name %>
                    </td>
                    <td>
                        <%- addCommas(shares) %>
                    </td>
                    <td class="<%- net_change_class %>">
                        <%- addCommas(net_change) %>
                    </td>
                    <% if (one_company) { %>
                        <th><%= common.format_datetime(position.timestamp).split(',')[0] %></th>
                    <% } %>
                </tr>
            <% }) %>

        </table>



    <% } %>
</div>

            </script>
        
            <script type="text/html" id="articles_tmpl" class="template">
                
<div class="articles">
    <% categories.forEach(function(category) { %>
        <% if(articles[category.key] && articles[category.key].length > 0) { %>
            <h3><%= category["title"] %></h3>

            <% var before = 2147483647000; %>
            <% if(articles[category.key]) { %>
                <!--
                <% articles[category.key].forEach(function(article, i) { %>
                    <%
                        var limit = show_all ? articles[category.key].length : category.limit;
                        if(i >= limit) {
                            return;
                        }

                        if(article.published_at < before) {
                            before = article.published_at;
                        } else {
                            before = article.created_at;
                        }
                    %>
                    --><a class="go-to article-link <%= article.last_seen ? 'seen' : 'unseen' %>" data-channel="<%= article.author %>/<%= article.slug %>" href="/<%= article.author %>/<%= article.slug %>" data-type="<%= category.key %>" data-index="<%= i %>">
                        <% var cls = (current_channel.toLowerCase() == (article.author+"/"+article.slug).toLowerCase()) ? 'current' : ''; %>
                        <div class="article <%= cls %>">
                            <div class="thumb">
                                <% if(article.thumbnail) { %>
                                    <img src="<%= article.thumbnail %>" />
                                <% } else { %>
                                    <img src="/public/assets/icon-bnw.png" />
                                <% } %>
                            </div>
                            <div class="details">
                                <span class="date"><%= common.format_date(article.published_at ? article.published_at : article.created_at) %></span>
                                <% if(logged_in == true) { %>
                                    <span class="dot" title="Unread article">●</span>
                                    <% if(article.new_message_count) { %>
                                        <span class="new-count">
                                            <%= article.new_message_count %> new comment<%= article.new_message_count > 1 ? 's' : '' %>
                                        </span>
                                    <% } %>
                                <% } %>
                                <br />
                                <span class="author" data-channel="<%= article.author %>" href="/<%= article.author%>"><%= article.author %></span> <span class="title"><%= article.title %></span>
                                <% var symbols = article.tags ? article.tags.filter(function(t){ return t[0] == "$" }).map(function(t){ return t.substring(1) }) : []; %>
                                <% symbols.forEach(function(symbol) { %>
                                    <span class='hash cash' data-channel="<%= symbol %>">$<%= symbol %></span>
                                <% }); %>
                            </div>
                        </div>
                    </a><!--
                <% }); %>
                -->
            <% } else { %>
                <div class='no-articles'></div>
            <% } %>
            <div class="load-more load-more-featured" data-type="<%= category.key %>" data-before="<%= before %>">show more ▾</div>
        <% } %>
    <% }); %>
</div>

            </script>
        
            <script type="text/html" id="spiel_filters_tmpl" class="template">
                <div class="spiel-filters inner">
    <% if(context.edit) { %>
        <form class='spiel-filters-form'>
            <table>
                <tr class='primary'>
                    <th style='font-size: 16px;'><span class='icon icon-search'></span></th>
                    <td>
                        <input type="text" name="terms" value="<%= context.filters_applied ? filters_applied.terms : '' %>" placeholder='Type keywords'  style='font-size: 16px;' />
                    </td>
                </tr>
                <tr>
                    <th>Name</th>
                    <td>
                        <input type="text" name="name" value="<%= context.filters_applied ? filters_applied.name : '' %>" placeholder="@Username" />
                    </td>
                </tr>
                <tr>
                    <th>Popularity</th>
                    <td>
                        <span class='icon icon-thumbsup'></span> &gt;
                        <input type="number" name="votes" style="width: 70px;" value="<%= context.filters_applied ? filters_applied.votes : '0' %>" placeholder="0" />
                    </td>
                </tr>
                <tr>
                    <th>User type</th>
                    <td>
                        <select name='user_type'>
                            <option value=''>All users</option>
                            <option value='hide_anonymous' <%= context.filters_applied && filters_applied.user_type == 'hide_anonymous' ? 'selected' : '' %>>Hide anonymous posters</option>
                            <option value='only_trusted' <%= context.filters_applied && filters_applied.user_type == 'only_trusted' ? 'selected' : '' %>>Only show trusted users</option>
                            <option value='only_anonymous' <%= context.filters_applied && filters_applied.user_type == 'only_anonymous' ? 'selected' : '' %>>Only show anonymous users</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th></th>
                    <td>
                        <input type='submit' value='Search <%= common.format_channel(current_channel) %>'/:
                    </td>
                </tr>
            </table>
        </form>
        <div class='controls'>
            <a href='#' class='remove-all-filters'><span class='icon icon-cross'></span></a>
        </div>
    <% } else { %>
        <span class='icon icon-search'></span>
        <% if(context.filters_applied) for(var key in filters_applied) if(filters_applied[key] && filters_applied[key]!=='') { %>
            <span class='applied-filter'><span class='key'><%= key.replace('_', ' ') %></span>: <%= String(filters_applied[key]).replace('_', ' ') %></span>
        <% } %>
        <div class='controls'>
            <a href='#' class='edit-filters'><span class='icon icon-pencil'></span></a>
            <a href='#' class='remove-all-filters'><span class='icon icon-cross'></span></a>
        </div>
    <% } %>
</div>



            </script>
        
            <script type="text/html" id="leaderboard_tmpl" class="template">
                <div class='leaderboard'>
    
    <div>
        <div class='leaderboard-nav'>
            <a class='leaderboard-tab <%= !context.show_exchange ? 'selected' : '' %>' href='#'>All</a>
            <% if(context.available_exchanges) context.available_exchanges.forEach(function(exch, i) { %>
                <a class='leaderboard-tab <%= context.show_exchange==exch.code ? 'selected' : '' %>' data-exchange='<%= exch.code %>' href='#'><%= exch.name %></a>    
            <% }); %>
        </div>
        <div class='disclaimer'>
            * Market caps calculated from total issued shares, as reported on the previous quarterly filings. Undiluted, excluding debt.
        </div>
    </div>
    <% if(context.exchanges) { %>
        <div class='tables-wrapper'>
            <% exchanges.forEach(function(exch, i) { %>
                <div class='stack'>
                    <h2><%= exch.name %></h2>
                    <table>
                        <% exch.market_caps.forEach(function(channel_obj, i) { %>
                            <tr>
                                <th><%= i+1 %></th>
                                <td class='watchlist'>
                                    <div class='section'>
                                        <div class='channels-list detailed'>
                                            <% var itemdata = {
                                                user: {},
                                                channel_item: channel_obj,
                                                current_channel: '',
                                                show_titles: true,
                                                logged_in: false,
                                                category_id: 1,
                                                quote_type: '%',
                                                
                                            }; %>
                                            <%- (typeof t !== 'undefined') ? t.render('partials/watchlist_item.html', itemdata) : Template("watchlist_item_tmpl", itemdata) %>
                                        </div>
                                    </div>
                                </td>
                                <td><span class='market-cap'>$<%= common.number_formatter(channel_obj.market_cap, 2, true) %></span></td>
                                <td></td>
                            </tr>
                        <% }); %>
                        <tr>
                            <td></td>
                            <td>
                                <a class='load-more' data-exchange='<%= exch.code %>' data-market-cap='<%= exch.market_caps[exch.market_caps.length-1].market_cap %>'>
                                    load more <span class='icon icon-chevron-down'></span></td>
                                </a>
                            <td></td>
                        </tr>
                    </table>
                </div>
            <% }); %>
        </div>
    <% } %>
</div>

            </script>
        
            <script type="text/html" id="settings_tmpl" class="template">
                
<% var channelData = context.settings; %>
<% var allOff = context.notifications_off %>

<% if(context.loading) { %>
    Loading...
<% } else { %>
    
    <h3>General settings</h3>
    <table class='general'>
        <tr>
            <th>
                <label>Email/Push notifications</label>
                <% if(!allOff) { %>
                    <div class="notification-status-on"> Notifications are Enabled. </div>
                <% } else { %>
                    <div class="notification-status-off"> Notifications are Disabled. </div>
                <% } %>
            </th>
            <td>
                <% if(!allOff) { %>
                    <span id="notifications-button" class="settings-switch disable"><span class='icon icon-cross'></span> Turn off ALL notifications</span>
                <% } else { %>
                    <span id="notifications-button" class="settings-switch enable"><span class='icon icon-plus'></span> Turn on notifications</span>
                <% } %>
            </td>
        </tr>
        <tr>
            <th>
                <label>Quote display</label>
                <div>Sidebar stock prices show <%= context.quote_type == "%" ? "%" : "$" %> value</div>
            </th>
            <td>
                <span id='toggle-quote-type' class='settings-switch'><span class='icon'><%= context.quote_type == "%" ? "%" : "$" %></span> Toggle quote display</span>
            </td>
        </tr>
        <tr>
            <th>
                <label>Sound</label>
                <div>Sound is <u><%= context.mute_audio ? "off" : "on" %></u> for<br />private &amp; direct messages</div>
            </th>
            <td>
                <span id='audio' class='settings-switch' title='Toggle sound for new messages'><span class='icon <%= context.mute_audio === true ? "icon-volume-mute" : "icon-volume-medium" %>'></span> Toggle sound</span>
            </td>
        </tr>
        <tr>
            <th>
                <label>Browse anonymously</label>
                <div>Your handle is <strong><u><%= context.incognito ? 'hidden from' : 'visible in' %></u></strong><br /> company channels.
            </th >
            <td>
                <div>
                    <% if(context.pro_subscriber) { %>
                        <% if(context.incognito) { %>
                            <span id='toggle-incognito' class='settings-switch'>Show my name in online lists</span>
                        <% } else { %>
                            <span id='toggle-incognito' class='settings-switch'>Hide my name in online lists</span>
                        <% } %>
                    <% } else { %>
                        This feature is only available<br />to <a href='/about/market-depth'>Pro subscribers</a>.
                    <% } %>
                </div>
            </td>
        </tr>
    </table>

    <% if(context.user_filters && user_filters.length > 0) { %>
        <h3>Ignores &amp; Blocks</h3>
        <table class="<%= (allOff == true ? 'blur-table' : '') %>">
            
            <% for(var i=0; i < user_filters.length; i++) { var user_filter = user_filters[i]; %>
            <tr channel="<%= user_filter.target_user_name %>">
                <td class="channel">
                    <span class="formatted-channel">
                        <span class="channel go-to" data-channel="<%= user_filter.target_user_name %>">
                            <%=user_filter.target_user_name || "anonymous" %>
                        </span>
                    </span>
                </td>
                <td>
                    <%= user_filter.type == 'block' ? 'Blocked' : '' %>
                    <%= user_filter.type == 'ignore' ? 'Ignored' : '' %>
                    &nbsp;
                    <a href='#' class='remove-ignore-block' data-type='<%= user_filter.type %>' data-filter-id='<%= user_filter.id %>'><span class='icon icon-cross'></span> remove</a>
                </td>
            </tr>
            <% } %>
        </table>
    <% } %>

    <% if(!allOff) { %>
        <h3>Per-channel notification settings</h3>
        <table align="center" class="<%= (allOff == true ? 'blur-table' : '') %>">
            <tr>
                <th>Channel</th>
                <th>E-mail</th>
                <% if(context.has_mobile) { %>
                    <th>Push</th>
                <% } %>
            </tr>
            
            <% channelData = channelData.sort(function(a, b){ if(a.channel < b.channel) return -1; else return 1; }) %>
            <% for(var i=0; i < channelData.length; i++) { var channel = channelData[i]; %>
            <tr channel="<%= channel.channel %>">
                <td class="channel">
                    <span class="formatted-channel">
                        <span class="channel go-to" data-channel="<%= channel.channel %>">
                            <%

                                var item = {
                                    type: channel.symbol ? 'cash' : 'hash',
                                    channel: channel.channel,
                                }

                                var formatting = common.get_channel_formatting(item);

                            %>
                            <%- formatting.icon ? formatting.icon : '' %><%= formatting.label %>
                        </span>
                    </span>
                </td>
                <td>
                    <span class='icon icon-envelope'></span>
                    <select id="notifcation_select" name="mail">
                        <% var choice = channel.email_frequency %>
                        <option value="daily" <%= (choice == "daily") ? 'selected' : '' %> >all messages</option>
                        <option value="news" <%= (choice == null || choice == "news") ? 'selected' : '' %>>only news</option>
                        <option value="off" <%= (choice == null || choice == "off") ? 'selected' : '' %> >off</option> 
                    </select>
                </td>
                <% if(context.has_mobile) { %>
                    <td>
                        <span class='icon icon-mobile'></span>
                        <select id="notifcation_select" name="mobile">
                            <% var choice = channel.push_frequency %>
                            <option value="daily" <%= (choice == "daily") ? 'selected' : '' %> >all messages</option>
                            <option value="news" <%= (choice == null || choice == "news") ? 'selected' : '' %>>only news</option>
                            <option value="off" <%= (choice == null || choice == "off") ? 'selected' : '' %> >off</option>
                        </select>
                    </td>
                <% } %>
            </tr>
            <% } %>
        </table>

    <% } else { %>
    <% } %>

<% } %>

            </script>
        
            <script type="text/html" id="spiel_feedback_reason_tmpl" class="template">
                <% if(context.upvoted) { %>
    <div class='padding'>
        <span class='big icon icon-thumbsup'></span>
        Choose a reason for your thumbs up:
        <div class='reasons'>
            <div class='reason'>Agree</div>
            <div class='reason'>Good DD</div>
            <div class='reason'>Funny</div>
            <div class='reason'>Helpful</div>
        </div>
    </div>
<% } %>
<% if(context.flagged) { %>
    <div class='padding'>
        <span class='big icon icon-flag'></span>
        Choose a reason for your flag:
        <div class='reasons'>
            <% if(context.rules) rules.forEach(function(rule) { %>
                <div class='reason' data-id='<%= rule.id %>'><%= rule.rule_flagname %></div>
            <% }); %>
        </div>
        <div class='msg'></div>
    </div>
<% } %>
<%- context.spiel_row %>

            </script>
        

        <script type="text/javascript">

            window.templates = {}
            var templs = document.getElementsByClassName('template');
            for(var i=0; i<templs.length; i++) {
                var templ = templs[i]
                var id = templ.id;
                var content = templ.innerHTML;
                templates[id] = microtemplates(content);
            }
            Template = function(id, data) {
                data.common = common;
                return templates[id](data);
            }

        </script>

        

        <script type="text/javascript">
            window.prod = true;
            window.pro = false;
            window.allowed_exchanges = [];

            window.static_url = '/public/';

            window.handle =  null 

            window.networking = null;
            window.ui = null;

            window.since = undefined;

            window.user_verified = false

            window.spiel_id = null;

            window.quote = null;

            window.last_spiel_date = 0;
            window.latitude = null;
            window.longitude = null;
            window.gps_accuracy = null;
            window.spiels_per_request = 50;
            window.messages_to_send_on_reconnect = [];
            window.user_logged_in = false;

            window.latest_spiel_id = "";

            window.dragging = false;
            window.mousedown_coordinates = null;
            window.features = {"stock_charts":true};

            

            $(document).ready(function(){

                window.scroll = Scroll();

                if(is_touch_device()) {
                    window.touch_device = true;
                    
                    $('#type-here, #name').focus(function(e){
                        window.scroll.animate_to('bottom');
                    });

                    $('#chat, #post, .left-sidebar, #home').on('touchstart', function(e) {
                        if(window.layout.state.right_sidebar) {
                            // close sidebar when clicked outside
                            var w = window,
                            d = document,
                            e = d.documentElement,
                            g = d.getElementsByTagName('body')[0],
                            x = w.innerWidth || e.clientWidth || g.clientWidth,
                            y = w.innerHeight|| e.clientHeight|| g.clientHeight;

                            if(x < 600) {
                                window.layout.close_right_sidebar();
                            }
                        }
                    });
                } else {
                    $('#type-here').focus();
                    $('body').on('click', function(e){
                        if(e.target.tagName != ":MAMMOTH-MINI-WINDOW:" &&
                          !$(e.target).is('input') &&
                          !$(e.target).is('select') &&
                          !$(e.target).is('textarea') &&
                          !$(e.target).is('#article-editor-modal') &&
                          !($(e.target).parents('#article-editor-modal').length > 0) &&
                          !window.dragging && $(e.target).prop('contenteditable') != "true" &&
                          $(e.target).find(".spiel-content").prop('contenteditable') != "true" ) {
                            setTimeout(function() {
                                $('#type-here').focus();
                            }, 100);
                        }
                        window.dragging = false;
                    });
                    $('body').on('mousedown', function(e){
                        window.dragging = true;
                        window.mousedown_coordinates = { x: e.pageX, y: e.pageY };
                    });
                    $('body').on('mouseup', function(e){
                        if(pixel_distance(e.pageX, e.pageY, window.mousedown_coordinates.x, window.mousedown_coordinates.y) < 10) {
                            window.dragging = false;
                        }
                    });
                }
                if(window.navigator.standalone) {
                    $('#header').css('padding-top', '24px');

                    $('body').on('click', 'a', function(e){

                        var hostname = $(this)[0].hostname
                        if($.inArray(hostname, ['teaorbit.com', 'www.teaorbit.com', 'safinaz.local']) != -1) {
                            e.preventDefault();
                            document.location = $(this).attr('href');
                        }
                    });
                }

                window.first_spiels = [];
                window.stock_info = null;

                window.post = Post({"logged_in":false,"user":null,"user_verified":false,"color":"#6c63e3","channel":"@tommy/privacy-policy","readable":true,"writable":true,"banned":false,"text":"","role":null,"t":{},"common":{"market_map":{"113":"V","127":"TO","130":"CN","V":"113","TO":"127","CN":"130"},"regexes":{"panel":{},"hash":{},"cash":{},"user":{}}},"STATIC_URL":"/public/"});
                window.events = new Events();

                window.ui = new UI('@tommy/privacy-policy', '', {"rules":[{"id":1,"rule_flagname":"Insult/Personal Attack"},{"id":2,"rule_flagname":"Doesn't add value"},{"id":3,"rule_flagname":"Repetitive"},{"id":4,"rule_flagname":"Blaming"},{"id":5,"rule_flagname":"Cheerleading"},{"id":6,"rule_flagname":"Spamming"},{"id":7,"rule_flagname":"Needs to Lighten Up"},{"id":8,"rule_flagname":"Inappropriate"}]});
                window.ui.init();

                window.layout = Layout();
                window.online_list = OnlineList(1, 0);
                window.nav = Nav({});

                window.url_history = UrlHistory();

                
                    window.ui.init_web_only_features();
                

                window.sidebar = new Sidebar([{"channel":"index","type":"hash","category":"featured","new_message_count":0},{"channel":"popular","type":"hash","category":"featured","new_message_count":0},{"channel":"featured","type":"hash","category":"featured","new_message_count":0},{"channel":"articles","type":"hash","category":"featured","new_message_count":0},{"channel":"newsroom","type":"hash","category":"featured","new_message_count":0},{"channel":"insiders","type":"hash","category":"featured","new_message_count":0},{"channel":"feedback","type":"hash","category":"featured","new_message_count":0}], [], false, "@tommy/privacy-policy", false, null);

                window.sidebar.init();

                window.discover = Discover({"current_channel":"@tommy/privacy-policy","articles":{"featured":[{"slug":"observations-from-the-yukon-and-a-failed-breakdown-in-the-gold-miners","thumbnail":"https://s3-us-west-2.amazonaws.com/cdn.ceo.ca/1dj0akl-GDX_Daily_6-120-80-thumb.24.2018.png","title":"Observations From The Yukon And A Failed Breakdown In The Gold Miners","published_at":1529885323549,"created_at":1529885320621,"pinned":null,"author":"@Goldfinger","tags":["featured"],"channel":"@goldfinger/observations-from-the-yukon-and-a-failed-breakdown-in-the-gold-miners","last_seen":null,"new_message_count":null},{"slug":"recommended-cash-offer-by-orion-mine-finance-to-acquire","thumbnail":null,"title":"Recommended Cash Offer by Orion Mine Finance to Acquire Dalradian Resources Inc.","published_at":1529560825498,"created_at":1529560825498,"pinned":null,"author":"@nasdaq","tags":["nasdaq","$DNA","$DALR","noteworthy","featured"],"channel":"@nasdaq/recommended-cash-offer-by-orion-mine-finance-to-acquire","last_seen":null,"new_message_count":null},{"slug":"oreninc-index-falls-financing-drought-continues","thumbnail":"https://s3-us-west-2.amazonaws.com/cdn.ceo.ca/1dih7up-Index%2520Image%25206-14-18-01-120-80-thumb.jpg","title":"ORENINC INDEX falls, financing drought continues","published_at":1529389452822,"created_at":1529389433336,"pinned":null,"author":"@Oreninc","tags":["featured"],"channel":"@oreninc/oreninc-index-falls-financing-drought-continues","last_seen":null,"new_message_count":null},{"slug":"former-speaker-boehner-makes-a-cool-million-on-arizona-mining-deal","thumbnail":"https://s3-us-west-2.amazonaws.com/cdn.ceo.ca/1digkj0-Boehner-120-80-thumb.jpg","title":"Former Speaker Boehner Earns a Cool Million on Arizona Mining Deal","published_at":1529368094772,"created_at":1529366405391,"pinned":null,"author":"@tommy","tags":["featured"],"channel":"@tommy/former-speaker-boehner-makes-a-cool-million-on-arizona-mining-deal","last_seen":null,"new_message_count":null}]},"categories":[{"key":"news","title":"news releases"},{"key":"user","title":"@tommy/privacy-policy's articles"},{"key":"featured","title":"featured articles"},{"key":"community","title":"community articles"}],"show_all":false,"show_more":false,"show_all_sponsors":false,"count":6,"logged_in":false,"pro":false,"admin":false,"t":{},"common":{"market_map":{"113":"V","127":"TO","130":"CN","V":"113","TO":"127","CN":"130"},"regexes":{"panel":{},"hash":{},"cash":{},"user":{}}},"STATIC_URL":"/public/"});
                window.channel_articles = ChannelArticles(window.discover.state);
                window.home = Home({"channel_categories":[{"id":"defaults","channels":[{"channel":"index","category":"featured","type":"hash","new_message_count":0},{"channel":"popular","category":"featured","type":"hash","new_message_count":0},{"channel":"featured","category":"featured","type":"hash","new_message_count":0},{"channel":"newsroom","category":"featured","type":"hash","new_message_count":0},{"channel":"insiders","category":"featured","type":"hash","new_message_count":0},{"channel":"feedback","category":"featured","type":"hash","new_message_count":0},{"channel":"newbies","category":"featured","type":"hash","new_message_count":0}]},{"id":"Commodities","channels":[{"channel":"gold","category":"commodities","symbol":"GC=F","type":"commodity","quote":{"price_change":"-2.30","direction":"down","value":1268.4,"percent_change":"-0.18%","symbol":"GC=F","volume":92302},"new_message_count":0},{"channel":"silver","category":"commodities","symbol":"SI=F","type":"commodity","quote":{"price_change":"-0.09","direction":"down","value":16.37,"percent_change":"-0.54%","symbol":"SI=F","volume":28310},"new_message_count":0},{"channel":"copper","category":"commodities","symbol":"HG=F","type":"commodity","quote":{"price_change":"-0.0075","direction":"down","value":3.0195,"percent_change":"-0.25%","symbol":"HG=F","volume":31245},"new_message_count":0},{"channel":"zinc","category":"commodities","symbol":"ZINC.LME","type":"commodity","quote":{"price_change":"-0.0184","direction":"down","value":1.329,"percent_change":"-1.36%","symbol":"ZINC.LME"},"new_message_count":0},{"channel":"oil","category":"commodities","symbol":"CL=F","type":"commodity","quote":{"price_change":"-0.10","direction":"down","value":68.48,"percent_change":"-0.15%","symbol":"CL=F","volume":182399},"new_message_count":0},{"channel":"bitcoin","category":"commodities","symbol":"BTC.CC","type":"commodity","quote":{"price_change":288.909282,"direction":"up","value":6199.77,"percent_change":"4.66%","symbol":"BTC.CC","volume":"4180060000.0"},"new_message_count":0},{"channel":"ethereum","category":"commodities","symbol":"ETH.CC","type":"commodity","quote":{"price_change":12.6838023,"direction":"up","value":457.899,"percent_change":"2.77%","symbol":"ETH.CC","volume":"2390980000.0"},"new_message_count":0}]}]});

                window.moderator = Moderator(1, 0, null, null);

                window.file_uploader = new fileUploader();
                window.file_uploader.init()
                window.notifications = new Notifications("@tommy/privacy-policy");
                window.notifications.init(false, user_logged_in)

                window.search = Search();
                window.profile = Profile();
                window.profiles = Profiles(null, null);

                window.articles = Articles();
                window.article = Article();

                window.banmodal = BanModal();
                window.impressions = Impressions();
            });

        </script>

        
        
            <script src="/public/js/user.js?v=369-2"></script>
        

        <script type="text/javascript">
            
                window.latest_spiel_id = $('.row').last().attr('id');
            
            
            $.timeago.settings.allowFuture = false;
            $.timeago.settings.filter = function(date) {
                return (date > common.now() - 1000*60*60*12);
            }
            $(document).find('time').timeago();
        </script>

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61253585-1', 'auto');
          ga('send', 'pageview');

        </script>

    

</body></html>